function wi(d,y){const{rows:_,columns:F,data:S}=d,{rows:t,columns:B,data:W}=y,H=[],N=[],V=[];for(let q=0;q<B;q++){const L=q*(F-1)/(B-1);H[q]=Math.floor(L),N[q]=Math.min(H[q]+1,F-1),V[q]=L-H[q]}for(let q=0;q<t;q++){const L=q*(_-1)/(t-1),Q=Math.floor(L)*F,J=Math.min(Q+F,(_-1)*F),te=L-Math.floor(L),ae=1-te,Se=q*B;for(let fe=0;fe<B;fe++){const Ce=S[Q+H[fe]],be=S[Q+N[fe]],oe=S[J+H[fe]],_e=S[J+N[fe]],Re=1-V[fe];W[Se+fe]=(Ce*Re+be*V[fe])*ae+(oe*Re+_e*V[fe])*te}}return W}function Pi(d,y){const{rows:_,columns:F,pixelData:S,samplesPerPixel:t=1}=d,{rows:B,columns:W,pixelData:H}=y,N=[];for(let V=0;V<W;V++){const q=V*(F-1)/(W-1);N[V]=Math.floor(q)*t}for(let V=0;V<B;V++){const q=V*(_-1)/(B-1),L=Math.floor(q)*F*t,Q=V*W;for(let J=0;J<W;J++)for(let te=0;te<t;te++)H[Q+J+te]=S[L+N[J]+te]}return H}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const li=Symbol("Comlink.proxy"),Ti=Symbol("Comlink.endpoint"),Ci=Symbol("Comlink.releaseProxy"),qn=Symbol("Comlink.finalizer"),Mn=Symbol("Comlink.thrown"),di=d=>typeof d=="object"&&d!==null||typeof d=="function",Ai={canHandle:d=>di(d)&&d[li],serialize(d){const{port1:y,port2:_}=new MessageChannel;return Qn(d,y),[_,[_]]},deserialize(d){return d.start(),Si(d)}},$i={canHandle:d=>di(d)&&Mn in d,serialize({value:d}){let y;return d instanceof Error?y={isError:!0,value:{message:d.message,name:d.name,stack:d.stack}}:y={isError:!1,value:d},[y,[]]},deserialize(d){throw d.isError?Object.assign(new Error(d.value.message),d.value):d.value}},pi=new Map([["proxy",Ai],["throw",$i]]);function Ri(d,y){for(const _ of d)if(y===_||_==="*"||_ instanceof RegExp&&_.test(y))return!0;return!1}function Qn(d,y=globalThis,_=["*"]){y.addEventListener("message",function F(S){if(!S||!S.data)return;if(!Ri(_,S.origin)){console.warn(`Invalid origin '${S.origin}' for comlink proxy`);return}const{id:t,type:B,path:W}=Object.assign({path:[]},S.data),H=(S.data.argumentList||[]).map(Dn);let N;try{const V=W.slice(0,-1).reduce((L,Q)=>L[Q],d),q=W.reduce((L,Q)=>L[Q],d);switch(B){case"GET":N=q;break;case"SET":V[W.slice(-1)[0]]=Dn(S.data.value),N=!0;break;case"APPLY":N=q.apply(V,H);break;case"CONSTRUCT":{const L=new q(...H);N=Oi(L)}break;case"ENDPOINT":{const{port1:L,port2:Q}=new MessageChannel;Qn(d,Q),N=xi(L,[L])}break;case"RELEASE":N=void 0;break;default:return}}catch(V){N={value:V,[Mn]:0}}Promise.resolve(N).catch(V=>({value:V,[Mn]:0})).then(V=>{const[q,L]=zn(V);y.postMessage(Object.assign(Object.assign({},q),{id:t}),L),B==="RELEASE"&&(y.removeEventListener("message",F),vi(y),qn in d&&typeof d[qn]=="function"&&d[qn]())}).catch(V=>{const[q,L]=zn({value:new TypeError("Unserializable return value"),[Mn]:0});y.postMessage(Object.assign(Object.assign({},q),{id:t}),L)})}),y.start&&y.start()}function Ei(d){return d.constructor.name==="MessagePort"}function vi(d){Ei(d)&&d.close()}function Si(d,y){const _=new Map;return d.addEventListener("message",function(S){const{data:t}=S;if(!t||!t.id)return;const B=_.get(t.id);if(B)try{B(t)}finally{_.delete(t.id)}}),Kn(d,_,[],y)}function Hn(d){if(d)throw new Error("Proxy has been released and is not useable")}function hi(d){return xn(d,new Map,{type:"RELEASE"}).then(()=>{vi(d)})}const Vn=new WeakMap,Bn="FinalizationRegistry"in globalThis&&new FinalizationRegistry(d=>{const y=(Vn.get(d)||0)-1;Vn.set(d,y),y===0&&hi(d)});function Fi(d,y){const _=(Vn.get(y)||0)+1;Vn.set(y,_),Bn&&Bn.register(d,y,d)}function ki(d){Bn&&Bn.unregister(d)}function Kn(d,y,_=[],F=function(){}){let S=!1;const t=new Proxy(F,{get(B,W){if(Hn(S),W===Ci)return()=>{ki(t),hi(d),y.clear(),S=!0};if(W==="then"){if(_.length===0)return{then:()=>t};const H=xn(d,y,{type:"GET",path:_.map(N=>N.toString())}).then(Dn);return H.then.bind(H)}return Kn(d,y,[..._,W])},set(B,W,H){Hn(S);const[N,V]=zn(H);return xn(d,y,{type:"SET",path:[..._,W].map(q=>q.toString()),value:N},V).then(Dn)},apply(B,W,H){Hn(S);const N=_[_.length-1];if(N===Ti)return xn(d,y,{type:"ENDPOINT"}).then(Dn);if(N==="bind")return Kn(d,y,_.slice(0,-1));const[V,q]=ri(H);return xn(d,y,{type:"APPLY",path:_.map(L=>L.toString()),argumentList:V},q).then(Dn)},construct(B,W){Hn(S);const[H,N]=ri(W);return xn(d,y,{type:"CONSTRUCT",path:_.map(V=>V.toString()),argumentList:H},N).then(Dn)}});return Fi(t,d),t}function Di(d){return Array.prototype.concat.apply([],d)}function ri(d){const y=d.map(zn);return[y.map(_=>_[0]),Di(y.map(_=>_[1]))]}const gi=new WeakMap;function xi(d,y){return gi.set(d,y),d}function Oi(d){return Object.assign(d,{[li]:!0})}function zn(d){for(const[y,_]of pi)if(_.canHandle(d)){const[F,S]=_.serialize(d);return[{type:"HANDLER",name:y,value:F},S]}return[{type:"RAW",value:d},gi.get(d)||[]]}function Dn(d){switch(d.type){case"HANDLER":return pi.get(d.name).deserialize(d.value);case"RAW":return d.value}}function xn(d,y,_,F){return new Promise(S=>{const t=Ii();y.set(t,S),d.start&&d.start(),d.postMessage(Object.assign({id:t},_),F)})}function Ii(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}async function ni(d,y){let _=y.buffer,F=y.byteOffset;const S=y.length;return d.bitsAllocated===16?(F%2&&(_=_.slice(F),F=0),d.pixelRepresentation===0?d.pixelData=new Uint16Array(_,F,S/2):d.pixelData=new Int16Array(_,F,S/2)):d.bitsAllocated===8||d.bitsAllocated===1?d.pixelData=y:d.bitsAllocated===32&&(F%2&&(_=_.slice(F),F=0),d.pixelData=new Float32Array(_,F,S/4)),d}function ji(d){return(d&255)<<8|d>>8&255}async function Ui(d,y){if(d.bitsAllocated===16){let _=y.buffer,F=y.byteOffset;const S=y.length;F%2&&(_=_.slice(F),F=0),d.pixelRepresentation===0?d.pixelData=new Uint16Array(_,F,S/2):d.pixelData=new Int16Array(_,F,S/2);for(let t=0;t<d.pixelData.length;t++)d.pixelData[t]=ji(d.pixelData[t])}else d.bitsAllocated===8&&(d.pixelData=y);return d}async function Wi(d,y){if(d.bitsAllocated===8)return d.planarConfiguration?Mi(d,y):Hi(d,y);if(d.bitsAllocated===16)return Li(d,y);throw new Error("unsupported pixel format for RLE")}function Hi(d,y){const _=y,F=d.rows*d.columns,S=new ArrayBuffer(F*d.samplesPerPixel),t=new DataView(_.buffer,_.byteOffset),B=new Int8Array(_.buffer,_.byteOffset),W=new Int8Array(S);let H=0;const N=t.getInt32(0,!0);for(let V=0;V<N;++V){H=V;let q=t.getInt32((V+1)*4,!0),L=t.getInt32((V+2)*4,!0);L===0&&(L=_.length);const Q=F*N;for(;q<L;){const J=B[q++];if(J>=0&&J<=127)for(let te=0;te<J+1&&H<Q;++te)W[H]=B[q++],H+=d.samplesPerPixel;else if(J<=-1&&J>=-127){const te=B[q++];for(let ae=0;ae<-J+1&&H<Q;++ae)W[H]=te,H+=d.samplesPerPixel}}}return d.pixelData=new Uint8Array(S),d}function Mi(d,y){const _=y,F=d.rows*d.columns,S=new ArrayBuffer(F*d.samplesPerPixel),t=new DataView(_.buffer,_.byteOffset),B=new Int8Array(_.buffer,_.byteOffset),W=new Int8Array(S);let H=0;const N=t.getInt32(0,!0);for(let V=0;V<N;++V){H=V*F;let q=t.getInt32((V+1)*4,!0),L=t.getInt32((V+2)*4,!0);L===0&&(L=_.length);const Q=F*N;for(;q<L;){const J=B[q++];if(J>=0&&J<=127)for(let te=0;te<J+1&&H<Q;++te)W[H]=B[q++],H++;else if(J<=-1&&J>=-127){const te=B[q++];for(let ae=0;ae<-J+1&&H<Q;++ae)W[H]=te,H++}}}return d.pixelData=new Uint8Array(S),d}function Li(d,y){const _=y,F=d.rows*d.columns,S=new ArrayBuffer(F*d.samplesPerPixel*2),t=new DataView(_.buffer,_.byteOffset),B=new Int8Array(_.buffer,_.byteOffset),W=new Int8Array(S),H=t.getInt32(0,!0);for(let N=0;N<H;++N){let V=0;const q=N===0?1:0;let L=t.getInt32((N+1)*4,!0),Q=t.getInt32((N+2)*4,!0);for(Q===0&&(Q=_.length);L<Q;){const J=B[L++];if(J>=0&&J<=127)for(let te=0;te<J+1&&V<F;++te)W[V*2+q]=B[L++],V++;else if(J<=-1&&J>=-127){const te=B[L++];for(let ae=0;ae<-J+1&&V<F;++ae)W[V*2+q]=te,V++}}}return d.pixelRepresentation===0?d.pixelData=new Uint16Array(S):d.pixelData=new Int16Array(S),d}function Nn(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function Vi(d){if(d.__esModule)return d;var y=d.default;if(typeof y=="function"){var _=function F(){return this instanceof F?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};_.prototype=y.prototype}else _={};return Object.defineProperty(_,"__esModule",{value:!0}),Object.keys(d).forEach(function(F){var S=Object.getOwnPropertyDescriptor(d,F);Object.defineProperty(_,F,S.get?S:{enumerable:!0,get:function(){return d[F]}})}),_}var Gn={exports:{}},Bi={},zi=Object.freeze({__proto__:null,default:Bi}),an=Vi(zi),ii;function Ni(){return ii||(ii=1,function(d,y){var _=(()=>{var F=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(F=F||__filename),function(S){S=S||{};var t=typeof S<"u"?S:{},B,W;t.ready=new Promise(function(e,r){B=e,W=r});var H=Object.assign({},t),N="./this.program",V=(e,r)=>{throw r},q=typeof window=="object",L=typeof importScripts=="function",Q=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",J="";function te(e){return t.locateFile?t.locateFile(e,J):J+e}var ae,Se,fe;if(Q){var Ce=an,be=an;L?J=be.dirname(J)+"/":J=__dirname+"/",ae=(e,r)=>(e=sr(e)?new URL(e):be.normalize(e),Ce.readFileSync(e,r?void 0:"utf8")),fe=e=>{var r=ae(e,!0);return r.buffer||(r=new Uint8Array(r)),r},Se=(e,r,u)=>{e=sr(e)?new URL(e):be.normalize(e),Ce.readFile(e,function(c,v){c?u(c):r(v.buffer)})},process.argv.length>1&&(N=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof Pr))throw e}),process.on("unhandledRejection",function(e){throw e}),V=(e,r)=>{throw process.exitCode=e,r},t.inspect=function(){return"[Emscripten Module object]"}}else(q||L)&&(L?J=self.location.href:typeof document<"u"&&document.currentScript&&(J=document.currentScript.src),F&&(J=F),J.indexOf("blob:")!==0?J=J.substr(0,J.replace(/[?#].*/,"").lastIndexOf("/")+1):J="",ae=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},L&&(fe=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),Se=(e,r,u)=>{var c=new XMLHttpRequest;c.open("GET",e,!0),c.responseType="arraybuffer",c.onload=()=>{if(c.status==200||c.status==0&&c.response){r(c.response);return}u()},c.onerror=u,c.send(null)});var oe=t.print||console.log.bind(console),_e=t.printErr||console.warn.bind(console);Object.assign(t,H),H=null,t.arguments&&t.arguments,t.thisProgram&&(N=t.thisProgram),t.quit&&(V=t.quit);var Re;t.wasmBinary&&(Re=t.wasmBinary);var ht=t.noExitRuntime||!0;typeof WebAssembly!="object"&&we("no native wasm support detected");var ot,Xe=!1;function at(e,r){e||we(r)}var or=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function _r(e,r,u){for(var c=r+u,v=r;e[v]&&!(v>=c);)++v;if(v-r>16&&e.buffer&&or)return or.decode(e.subarray(r,v));for(var b="";r<v;){var T=e[r++];if(!(T&128)){b+=String.fromCharCode(T);continue}var w=e[r++]&63;if((T&224)==192){b+=String.fromCharCode((T&31)<<6|w);continue}var A=e[r++]&63;if((T&240)==224?T=(T&15)<<12|w<<6|A:T=(T&7)<<18|w<<12|A<<6|e[r++]&63,T<65536)b+=String.fromCharCode(T);else{var j=T-65536;b+=String.fromCharCode(55296|j>>10,56320|j&1023)}}return b}function Lt(e,r){return e?_r(Z,e,r):""}function st(e,r,u,c){if(!(c>0))return 0;for(var v=u,b=u+c-1,T=0;T<e.length;++T){var w=e.charCodeAt(T);if(w>=55296&&w<=57343){var A=e.charCodeAt(++T);w=65536+((w&1023)<<10)|A&1023}if(w<=127){if(u>=b)break;r[u++]=w}else if(w<=2047){if(u+1>=b)break;r[u++]=192|w>>6,r[u++]=128|w&63}else if(w<=65535){if(u+2>=b)break;r[u++]=224|w>>12,r[u++]=128|w>>6&63,r[u++]=128|w&63}else{if(u+3>=b)break;r[u++]=240|w>>18,r[u++]=128|w>>12&63,r[u++]=128|w>>6&63,r[u++]=128|w&63}}return r[u]=0,u-v}function me(e,r,u){return st(e,Z,r,u)}function le(e){for(var r=0,u=0;u<e.length;++u){var c=e.charCodeAt(u);c<=127?r++:c<=2047?r+=2:c>=55296&&c<=57343?(r+=4,++u):r+=3}return r}var ge,ce,Z,ne,de,Oe,pe,Vt,Bt;function zt(e){ge=e,t.HEAP8=ce=new Int8Array(e),t.HEAP16=ne=new Int16Array(e),t.HEAP32=Oe=new Int32Array(e),t.HEAPU8=Z=new Uint8Array(e),t.HEAPU16=de=new Uint16Array(e),t.HEAPU32=pe=new Uint32Array(e),t.HEAPF32=Vt=new Float32Array(e),t.HEAPF64=Bt=new Float64Array(e)}t.INITIAL_MEMORY;var ar,mr=[],jr=[],Ur=[];function sn(){return ht}function un(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ke(t.preRun.shift());ft(mr)}function Ft(){ft(jr)}function Ye(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)qt(t.postRun.shift());ft(Ur)}function Ke(e){mr.unshift(e)}function Nt(e){jr.unshift(e)}function qt(e){Ur.unshift(e)}var Be=0,ut=null;function Gt(e){Be++,t.monitorRunDependencies&&t.monitorRunDependencies(Be)}function Ee(e){if(Be--,t.monitorRunDependencies&&t.monitorRunDependencies(Be),Be==0&&ut){var r=ut;ut=null,r()}}function we(e){t.onAbort&&t.onAbort(e),e="Aborted("+e+")",_e(e),Xe=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw W(r),r}var Ie="data:application/octet-stream;base64,";function br(e){return e.startsWith(Ie)}function sr(e){return e.startsWith("file://")}var ke;ke="libjpegturbowasm_decode.wasm",br(ke)||(ke=te(ke));function ur(e){try{if(e==ke&&Re)return new Uint8Array(Re);if(fe)return fe(e);throw"both async and sync fetching of the wasm failed"}catch(r){we(r)}}function wr(){if(!Re&&(q||L)){if(typeof fetch=="function"&&!sr(ke))return fetch(ke,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ke+"'";return e.arrayBuffer()}).catch(function(){return ur(ke)});if(Se)return new Promise(function(e,r){Se(ke,function(u){e(new Uint8Array(u))},r)})}return Promise.resolve().then(function(){return ur(ke)})}function Jt(){var e={a:M};function r(T,w){var A=T.exports;t.asm=A,ot=t.asm.K,zt(ot.buffer),ar=t.asm.M,Nt(t.asm.L),Ee()}Gt();function u(T){r(T.instance)}function c(T){return wr().then(function(w){return WebAssembly.instantiate(w,e)}).then(function(w){return w}).then(T,function(w){_e("failed to asynchronously prepare wasm: "+w),we(w)})}function v(){return!Re&&typeof WebAssembly.instantiateStreaming=="function"&&!br(ke)&&!sr(ke)&&!Q&&typeof fetch=="function"?fetch(ke,{credentials:"same-origin"}).then(function(T){var w=WebAssembly.instantiateStreaming(T,e);return w.then(u,function(A){return _e("wasm streaming compile failed: "+A),_e("falling back to ArrayBuffer instantiation"),c(u)})}):c(u)}if(t.instantiateWasm)try{var b=t.instantiateWasm(e,r);return b}catch(T){_e("Module.instantiateWasm callback failed with error: "+T),W(T)}return v().catch(W),{}}function Pr(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function ft(e){for(;e.length>0;)e.shift()(t)}function ze(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(r){pe[this.ptr+4>>2]=r},this.get_type=function(){return pe[this.ptr+4>>2]},this.set_destructor=function(r){pe[this.ptr+8>>2]=r},this.get_destructor=function(){return pe[this.ptr+8>>2]},this.set_refcount=function(r){Oe[this.ptr>>2]=r},this.set_caught=function(r){r=r?1:0,ce[this.ptr+12>>0]=r},this.get_caught=function(){return ce[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,ce[this.ptr+13>>0]=r},this.get_rethrown=function(){return ce[this.ptr+13>>0]!=0},this.init=function(r,u){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(u),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var r=Oe[this.ptr>>2];Oe[this.ptr>>2]=r+1},this.release_ref=function(){var r=Oe[this.ptr>>2];return Oe[this.ptr>>2]=r-1,r===1},this.set_adjusted_ptr=function(r){pe[this.ptr+16>>2]=r},this.get_adjusted_ptr=function(){return pe[this.ptr+16>>2]},this.get_exception_ptr=function(){var r=C(this.get_type());if(r)return pe[this.excPtr>>2];var u=this.get_adjusted_ptr();return u!==0?u:this.excPtr}}function je(e,r,u){var c=new ze(e);throw c.init(r,u),e}var Pe={};function Ct(e){for(;e.length;){var r=e.pop(),u=e.pop();u(r)}}function At(e){return this.fromWireType(Oe[e>>2])}var Qe={},gt={},$t={},fr=48,jt=57;function Me(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var r=e.charCodeAt(0);return r>=fr&&r<=jt?"_"+e:e}function kt(e,r){return e=Me(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(r)}function Ne(e,r){var u=kt(r,function(c){this.name=r,this.message=c;var v=new Error(c).stack;v!==void 0&&(this.stack=this.toString()+`
`+v.replace(/^Error(:[^\n]*)?\n/,""))});return u.prototype=Object.create(e.prototype),u.prototype.constructor=u,u.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},u}var yt=void 0;function ct(e){throw new yt(e)}function qe(e,r,u){e.forEach(function(w){$t[w]=r});function c(w){var A=u(w);A.length!==e.length&&ct("Mismatched type converter count");for(var j=0;j<e.length;++j)Ze(e[j],A[j])}var v=new Array(r.length),b=[],T=0;r.forEach((w,A)=>{gt.hasOwnProperty(w)?v[A]=gt[w]:(b.push(w),Qe.hasOwnProperty(w)||(Qe[w]=[]),Qe[w].push(()=>{v[A]=gt[w],++T,T===b.length&&c(v)}))}),b.length===0&&c(v)}function De(e){var r=Pe[e];delete Pe[e];var u=r.rawConstructor,c=r.rawDestructor,v=r.fields,b=v.map(T=>T.getterReturnType).concat(v.map(T=>T.setterArgumentType));qe([e],b,T=>{var w={};return v.forEach((A,j)=>{var U=A.fieldName,z=T[j],Y=A.getter,he=A.getterContext,ue=T[j+v.length],ve=A.setter,it=A.setterContext;w[U]={read:It=>z.fromWireType(Y(he,It)),write:(It,on)=>{var Mt=[];ve(it,It,ue.toWireType(Mt,on)),Ct(Mt)}}}),[{name:r.name,fromWireType:function(A){var j={};for(var U in w)j[U]=w[U].read(A);return c(A),j},toWireType:function(A,j){for(var U in w)if(!(U in j))throw new TypeError('Missing field:  "'+U+'"');var z=u();for(U in w)w[U].write(z,j[U]);return A!==null&&A.push(c,z),z},argPackAdvance:8,readValueFromPointer:At,destructorFunction:c}]})}function Dt(e,r,u,c,v){}function K(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function xe(){for(var e=new Array(256),r=0;r<256;++r)e[r]=String.fromCharCode(r);ie=e}var ie=void 0;function ye(e){for(var r="",u=e;Z[u];)r+=ie[Z[u++]];return r}var _t=void 0;function re(e){throw new _t(e)}function Ze(e,r,u={}){if(!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");var c=r.name;if(e||re('type "'+c+'" must have a positive integer typeid pointer'),gt.hasOwnProperty(e)){if(u.ignoreDuplicateRegistrations)return;re("Cannot register type '"+c+"' twice")}if(gt[e]=r,delete $t[e],Qe.hasOwnProperty(e)){var v=Qe[e];delete Qe[e],v.forEach(b=>b())}}function cr(e,r,u,c,v){var b=K(u);r=ye(r),Ze(e,{name:r,fromWireType:function(T){return!!T},toWireType:function(T,w){return w?c:v},argPackAdvance:8,readValueFromPointer:function(T){var w;if(u===1)w=ce;else if(u===2)w=ne;else if(u===4)w=Oe;else throw new TypeError("Unknown boolean type size: "+r);return this.fromWireType(w[T>>b])},destructorFunction:null})}function Xt(e){if(!(this instanceof tt)||!(e instanceof tt))return!1;for(var r=this.$$.ptrType.registeredClass,u=this.$$.ptr,c=e.$$.ptrType.registeredClass,v=e.$$.ptr;r.baseClass;)u=r.upcast(u),r=r.baseClass;for(;c.baseClass;)v=c.upcast(v),c=c.baseClass;return r===c&&u===v}function Tr(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Yt(e){function r(u){return u.$$.ptrType.registeredClass.name}re(r(e)+" instance already deleted")}var $e=!1;function Rt(e){}function se(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function Ue(e){e.count.value-=1;var r=e.count.value===0;r&&se(e)}function lr(e,r,u){if(r===u)return e;if(u.baseClass===void 0)return null;var c=lr(e,r,u.baseClass);return c===null?null:u.downcast(c)}var lt={};function Cr(){return Object.keys(Le).length}function xt(){var e=[];for(var r in Le)Le.hasOwnProperty(r)&&e.push(Le[r]);return e}var et=[];function dr(){for(;et.length;){var e=et.pop();e.$$.deleteScheduled=!1,e.delete()}}var mt=void 0;function Kt(e){mt=e,et.length&&mt&&mt(dr)}function Wr(){t.getInheritedInstanceCount=Cr,t.getLiveInheritedInstances=xt,t.flushPendingDeletes=dr,t.setDelayFunction=Kt}var Le={};function fn(e,r){for(r===void 0&&re("ptr should not be undefined");e.baseClass;)r=e.upcast(r),e=e.baseClass;return r}function Qt(e,r){return r=fn(e,r),Le[r]}function Et(e,r){(!r.ptrType||!r.ptr)&&ct("makeClassHandle requires ptr and ptrType");var u=!!r.smartPtrType,c=!!r.smartPtr;return u!==c&&ct("Both smartPtrType and smartPtr must be specified"),r.count={value:1},bt(Object.create(e,{$$:{value:r}}))}function Ar(e){var r=this.getPointee(e);if(!r)return this.destructor(e),null;var u=Qt(this.registeredClass,r);if(u!==void 0){if(u.$$.count.value===0)return u.$$.ptr=r,u.$$.smartPtr=e,u.clone();var c=u.clone();return this.destructor(e),c}function v(){return this.isSmartPointer?Et(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:e}):Et(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var b=this.registeredClass.getActualType(r),T=lt[b];if(!T)return v.call(this);var w;this.isConst?w=T.constPointerType:w=T.pointerType;var A=lr(r,this.registeredClass,w.registeredClass);return A===null?v.call(this):this.isSmartPointer?Et(w.registeredClass.instancePrototype,{ptrType:w,ptr:A,smartPtrType:this,smartPtr:e}):Et(w.registeredClass.instancePrototype,{ptrType:w,ptr:A})}function bt(e){return typeof FinalizationRegistry>"u"?(bt=r=>r,e):($e=new FinalizationRegistry(r=>{Ue(r.$$)}),bt=r=>{var u=r.$$,c=!!u.smartPtr;if(c){var v={$$:u};$e.register(r,v,r)}return r},Rt=r=>$e.unregister(r),bt(e))}function St(){if(this.$$.ptr||Yt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=bt(Object.create(Object.getPrototypeOf(this),{$$:{value:Tr(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function Hr(){this.$$.ptr||Yt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&re("Object already scheduled for deletion"),Rt(this),Ue(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ve(){return!this.$$.ptr}function Mr(){return this.$$.ptr||Yt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&re("Object already scheduled for deletion"),et.push(this),et.length===1&&mt&&mt(dr),this.$$.deleteScheduled=!0,this}function $r(){tt.prototype.isAliasOf=Xt,tt.prototype.clone=St,tt.prototype.delete=Hr,tt.prototype.isDeleted=Ve,tt.prototype.deleteLater=Mr}function tt(){}function pr(e,r,u){if(e[r].overloadTable===void 0){var c=e[r];e[r]=function(){return e[r].overloadTable.hasOwnProperty(arguments.length)||re("Function '"+u+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[r].overloadTable+")!"),e[r].overloadTable[arguments.length].apply(this,arguments)},e[r].overloadTable=[],e[r].overloadTable[c.argCount]=c}}function Zt(e,r,u){t.hasOwnProperty(e)?(re("Cannot register public name '"+e+"' twice"),pr(t,e,e),t.hasOwnProperty(u)&&re("Cannot register multiple overloads of a function with the same number of arguments ("+u+")!"),t[e].overloadTable[u]=r):t[e]=r}function cn(e,r,u,c,v,b,T,w){this.name=e,this.constructor=r,this.instancePrototype=u,this.rawDestructor=c,this.baseClass=v,this.getActualType=b,this.upcast=T,this.downcast=w,this.pureVirtualFunctions=[]}function Rr(e,r,u){for(;r!==u;)r.upcast||re("Expected null or instance of "+u.name+", got an instance of "+r.name),e=r.upcast(e),r=r.baseClass;return e}function ln(e,r){if(r===null)return this.isReference&&re("null is not a valid "+this.name),0;r.$$||re('Cannot pass "'+hr(r)+'" as a '+this.name),r.$$.ptr||re("Cannot pass deleted object as a pointer of type "+this.name);var u=r.$$.ptrType.registeredClass,c=Rr(r.$$.ptr,u,this.registeredClass);return c}function dn(e,r){var u;if(r===null)return this.isReference&&re("null is not a valid "+this.name),this.isSmartPointer?(u=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,u),u):0;r.$$||re('Cannot pass "'+hr(r)+'" as a '+this.name),r.$$.ptr||re("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&r.$$.ptrType.isConst&&re("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);var c=r.$$.ptrType.registeredClass;if(u=Rr(r.$$.ptr,c,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&re("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?u=r.$$.smartPtr:re("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:u=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)u=r.$$.smartPtr;else{var v=r.clone();u=this.rawShare(u,vt.toHandle(function(){v.delete()})),e!==null&&e.push(this.rawDestructor,u)}break;default:re("Unsupporting sharing policy")}return u}function wt(e,r){if(r===null)return this.isReference&&re("null is not a valid "+this.name),0;r.$$||re('Cannot pass "'+hr(r)+'" as a '+this.name),r.$$.ptr||re("Cannot pass deleted object as a pointer of type "+this.name),r.$$.ptrType.isConst&&re("Cannot convert argument of type "+r.$$.ptrType.name+" to parameter type "+this.name);var u=r.$$.ptrType.registeredClass,c=Rr(r.$$.ptr,u,this.registeredClass);return c}function Pt(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function dt(e){this.rawDestructor&&this.rawDestructor(e)}function er(e){e!==null&&e.delete()}function Lr(){We.prototype.getPointee=Pt,We.prototype.destructor=dt,We.prototype.argPackAdvance=8,We.prototype.readValueFromPointer=At,We.prototype.deleteObject=er,We.prototype.fromWireType=Ar}function We(e,r,u,c,v,b,T,w,A,j,U){this.name=e,this.registeredClass=r,this.isReference=u,this.isConst=c,this.isSmartPointer=v,this.pointeeType=b,this.sharingPolicy=T,this.rawGetPointee=w,this.rawConstructor=A,this.rawShare=j,this.rawDestructor=U,!v&&r.baseClass===void 0?c?(this.toWireType=ln,this.destructorFunction=null):(this.toWireType=wt,this.destructorFunction=null):this.toWireType=dn}function Vr(e,r,u){t.hasOwnProperty(e)||ct("Replacing nonexistant public symbol"),t[e].overloadTable!==void 0&&u!==void 0||(t[e]=r,t[e].argCount=u)}function rt(e,r,u){var c=t["dynCall_"+e];return u&&u.length?c.apply(null,[r].concat(u)):c.call(null,r)}var tr=[];function Fe(e){var r=tr[e];return r||(e>=tr.length&&(tr.length=e+1),tr[e]=r=ar.get(e)),r}function rr(e,r,u){if(e.includes("j"))return rt(e,r,u);var c=Fe(r).apply(null,u);return c}function Br(e,r){var u=[];return function(){return u.length=0,Object.assign(u,arguments),rr(e,r,u)}}function He(e,r){e=ye(e);function u(){return e.includes("j")?Br(e,r):Fe(r)}var c=u();return typeof c!="function"&&re("unknown function pointer with signature "+e+": "+r),c}var pt=void 0;function Ut(e){var r=ee(e),u=ye(r);return X(r),u}function Er(e,r){var u=[],c={};function v(b){if(!c[b]&&!gt[b]){if($t[b]){$t[b].forEach(v);return}u.push(b),c[b]=!0}}throw r.forEach(v),new pt(e+": "+u.map(Ut).join([", "]))}function zr(e,r,u,c,v,b,T,w,A,j,U,z,Y){U=ye(U),b=He(v,b),w&&(w=He(T,w)),j&&(j=He(A,j)),Y=He(z,Y);var he=Me(U);Zt(he,function(){Er("Cannot construct "+U+" due to unbound types",[c])}),qe([e,r,u],c?[c]:[],function(ue){ue=ue[0];var ve,it;c?(ve=ue.registeredClass,it=ve.instancePrototype):it=tt.prototype;var It=kt(he,function(){if(Object.getPrototypeOf(this)!==on)throw new _t("Use 'new' to construct "+U);if(Mt.constructor_body===void 0)throw new _t(U+" has no accessible constructor");var ti=Mt.constructor_body[arguments.length];if(ti===void 0)throw new _t("Tried to invoke ctor of "+U+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Mt.constructor_body).toString()+") parameters instead!");return ti.apply(this,arguments)}),on=Object.create(it,{constructor:{value:It}});It.prototype=on;var Mt=new cn(U,It,on,Y,ve,b,w,j),bi=new We(U,Mt,!0,!1,!1),Zn=new We(U+"*",Mt,!1,!1,!1),ei=new We(U+" const*",Mt,!1,!0,!1);return lt[e]={pointerType:Zn,constPointerType:ei},Vr(he,It),[bi,Zn,ei]})}function vr(e,r){for(var u=[],c=0;c<e;c++)u.push(pe[r+c*4>>2]);return u}function Te(e,r){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var u=kt(e.name||"unknownFunctionName",function(){});u.prototype=e.prototype;var c=new u,v=e.apply(c,r);return v instanceof Object?v:c}function Wt(e,r,u,c,v){var b=r.length;b<2&&re("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var T=r[1]!==null&&u!==null,w=!1,A=1;A<r.length;++A)if(r[A]!==null&&r[A].destructorFunction===void 0){w=!0;break}for(var j=r[0].name!=="void",U="",z="",A=0;A<b-2;++A)U+=(A!==0?", ":"")+"arg"+A,z+=(A!==0?", ":"")+"arg"+A+"Wired";var Y="return function "+Me(e)+"("+U+`) {
if (arguments.length !== `+(b-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(b-2)+` args!');
}
`;w&&(Y+=`var destructors = [];
`);var he=w?"destructors":"null",ue=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],ve=[re,c,v,Ct,r[0],r[1]];T&&(Y+="var thisWired = classParam.toWireType("+he+`, this);
`);for(var A=0;A<b-2;++A)Y+="var arg"+A+"Wired = argType"+A+".toWireType("+he+", arg"+A+"); // "+r[A+2].name+`
`,ue.push("argType"+A),ve.push(r[A+2]);if(T&&(z="thisWired"+(z.length>0?", ":"")+z),Y+=(j?"var rv = ":"")+"invoker(fn"+(z.length>0?", ":"")+z+`);
`,w)Y+=`runDestructors(destructors);
`;else for(var A=T?1:2;A<r.length;++A){var it=A===1?"thisWired":"arg"+(A-2)+"Wired";r[A].destructorFunction!==null&&(Y+=it+"_dtor("+it+"); // "+r[A].name+`
`,ue.push(it+"_dtor"),ve.push(r[A].destructorFunction))}j&&(Y+=`var ret = retType.fromWireType(rv);
return ret;
`),Y+=`}
`,ue.push(Y);var It=Te(Function,ue).apply(null,ve);return It}function Ge(e,r,u,c,v,b){at(r>0);var T=vr(r,u);v=He(c,v),qe([],[e],function(w){w=w[0];var A="constructor "+w.name;if(w.registeredClass.constructor_body===void 0&&(w.registeredClass.constructor_body=[]),w.registeredClass.constructor_body[r-1]!==void 0)throw new _t("Cannot register multiple constructors with identical number of parameters ("+(r-1)+") for class '"+w.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return w.registeredClass.constructor_body[r-1]=()=>{Er("Cannot construct "+w.name+" due to unbound types",T)},qe([],T,function(j){return j.splice(1,0,null),w.registeredClass.constructor_body[r-1]=Wt(A,j,null,v,b),[]}),[]})}function nr(e,r,u,c,v,b,T,w){var A=vr(u,c);r=ye(r),b=He(v,b),qe([],[e],function(j){j=j[0];var U=j.name+"."+r;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),w&&j.registeredClass.pureVirtualFunctions.push(r);function z(){Er("Cannot call "+U+" due to unbound types",A)}var Y=j.registeredClass.instancePrototype,he=Y[r];return he===void 0||he.overloadTable===void 0&&he.className!==j.name&&he.argCount===u-2?(z.argCount=u-2,z.className=j.name,Y[r]=z):(pr(Y,r,U),Y[r].overloadTable[u-2]=z),qe([],A,function(ue){var ve=Wt(U,ue,j,b,T);return Y[r].overloadTable===void 0?(ve.argCount=u-2,Y[r]=ve):Y[r].overloadTable[u-2]=ve,[]}),[]})}var Sr=[],Ae=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Nr(e){e>4&&--Ae[e].refcount===0&&(Ae[e]=void 0,Sr.push(e))}function Je(){for(var e=0,r=5;r<Ae.length;++r)Ae[r]!==void 0&&++e;return e}function pn(){for(var e=5;e<Ae.length;++e)if(Ae[e]!==void 0)return Ae[e];return null}function Fr(){t.count_emval_handles=Je,t.get_first_emval=pn}var vt={toValue:e=>(e||re("Cannot use deleted val. handle = "+e),Ae[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var r=Sr.length?Sr.pop():Ae.length;return Ae[r]={refcount:1,value:e},r}}}};function nt(e,r){r=ye(r),Ze(e,{name:r,fromWireType:function(u){var c=vt.toValue(u);return Nr(u),c},toWireType:function(u,c){return vt.toHandle(c)},argPackAdvance:8,readValueFromPointer:At,destructorFunction:null})}function hr(e){if(e===null)return"null";var r=typeof e;return r==="object"||r==="array"||r==="function"?e.toString():""+e}function vn(e,r){switch(r){case 2:return function(u){return this.fromWireType(Vt[u>>2])};case 3:return function(u){return this.fromWireType(Bt[u>>3])};default:throw new TypeError("Unknown float type: "+e)}}function hn(e,r,u){var c=K(u);r=ye(r),Ze(e,{name:r,fromWireType:function(v){return v},toWireType:function(v,b){return b},argPackAdvance:8,readValueFromPointer:vn(r,c),destructorFunction:null})}function qr(e,r,u){switch(r){case 0:return u?function(v){return ce[v]}:function(v){return Z[v]};case 1:return u?function(v){return ne[v>>1]}:function(v){return de[v>>1]};case 2:return u?function(v){return Oe[v>>2]}:function(v){return pe[v>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function ir(e,r,u,c,v){r=ye(r);var b=K(u),T=z=>z;if(c===0){var w=32-8*u;T=z=>z<<w>>>w}var A=r.includes("unsigned"),j=(z,Y)=>{},U;A?U=function(z,Y){return j(Y,this.name),Y>>>0}:U=function(z,Y){return j(Y,this.name),Y},Ze(e,{name:r,fromWireType:T,toWireType:U,argPackAdvance:8,readValueFromPointer:qr(r,b,c!==0),destructorFunction:null})}function gn(e,r,u){var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],v=c[r];function b(T){T=T>>2;var w=pe,A=w[T],j=w[T+1];return new v(ge,j,A)}u=ye(u),Ze(e,{name:u,fromWireType:b,argPackAdvance:8,readValueFromPointer:b},{ignoreDuplicateRegistrations:!0})}function kr(e,r){r=ye(r);var u=r==="std::string";Ze(e,{name:r,fromWireType:function(c){var v=pe[c>>2],b=c+4,T;if(u)for(var w=b,A=0;A<=v;++A){var j=b+A;if(A==v||Z[j]==0){var U=j-w,z=Lt(w,U);T===void 0?T=z:(T+="\0",T+=z),w=j+1}}else{for(var Y=new Array(v),A=0;A<v;++A)Y[A]=String.fromCharCode(Z[b+A]);T=Y.join("")}return X(c),T},toWireType:function(c,v){v instanceof ArrayBuffer&&(v=new Uint8Array(v));var b,T=typeof v=="string";T||v instanceof Uint8Array||v instanceof Uint8ClampedArray||v instanceof Int8Array||re("Cannot pass non-string to std::string"),u&&T?b=le(v):b=v.length;var w=G(4+b+1),A=w+4;if(pe[w>>2]=b,u&&T)me(v,A,b+1);else if(T)for(var j=0;j<b;++j){var U=v.charCodeAt(j);U>255&&(X(A),re("String has UTF-16 code units that do not fit in 8 bits")),Z[A+j]=U}else for(var j=0;j<b;++j)Z[A+j]=v[j];return c!==null&&c.push(X,w),w},argPackAdvance:8,readValueFromPointer:At,destructorFunction:function(c){X(c)}})}var Gr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function yn(e,r){for(var u=e,c=u>>1,v=c+r/2;!(c>=v)&&de[c];)++c;if(u=c<<1,u-e>32&&Gr)return Gr.decode(Z.subarray(e,u));for(var b="",T=0;!(T>=r/2);++T){var w=ne[e+T*2>>1];if(w==0)break;b+=String.fromCharCode(w)}return b}function _n(e,r,u){if(u===void 0&&(u=2147483647),u<2)return 0;u-=2;for(var c=r,v=u<e.length*2?u/2:e.length,b=0;b<v;++b){var T=e.charCodeAt(b);ne[r>>1]=T,r+=2}return ne[r>>1]=0,r-c}function mn(e){return e.length*2}function bn(e,r){for(var u=0,c="";!(u>=r/4);){var v=Oe[e+u*4>>2];if(v==0)break;if(++u,v>=65536){var b=v-65536;c+=String.fromCharCode(55296|b>>10,56320|b&1023)}else c+=String.fromCharCode(v)}return c}function wn(e,r,u){if(u===void 0&&(u=2147483647),u<4)return 0;for(var c=r,v=c+u-4,b=0;b<e.length;++b){var T=e.charCodeAt(b);if(T>=55296&&T<=57343){var w=e.charCodeAt(++b);T=65536+((T&1023)<<10)|w&1023}if(Oe[r>>2]=T,r+=4,r+4>v)break}return Oe[r>>2]=0,r-c}function Pn(e){for(var r=0,u=0;u<e.length;++u){var c=e.charCodeAt(u);c>=55296&&c<=57343&&++u,r+=4}return r}function Jr(e,r,u){u=ye(u);var c,v,b,T,w;r===2?(c=yn,v=_n,T=mn,b=()=>de,w=1):r===4&&(c=bn,v=wn,T=Pn,b=()=>pe,w=2),Ze(e,{name:u,fromWireType:function(A){for(var j=pe[A>>2],U=b(),z,Y=A+4,he=0;he<=j;++he){var ue=A+4+he*r;if(he==j||U[ue>>w]==0){var ve=ue-Y,it=c(Y,ve);z===void 0?z=it:(z+="\0",z+=it),Y=ue+r}}return X(A),z},toWireType:function(A,j){typeof j!="string"&&re("Cannot pass non-string to C++ string type "+u);var U=T(j),z=G(4+U+r);return pe[z>>2]=U>>w,v(j,z+4,U+r),A!==null&&A.push(X,z),z},argPackAdvance:8,readValueFromPointer:At,destructorFunction:function(A){X(A)}})}function Tn(e,r,u,c,v,b){Pe[e]={name:ye(r),rawConstructor:He(u,c),rawDestructor:He(v,b),fields:[]}}function Xr(e,r,u,c,v,b,T,w,A,j){Pe[e].fields.push({fieldName:ye(r),getterReturnType:u,getter:He(c,v),getterContext:b,setterArgumentType:T,setter:He(w,A),setterContext:j})}function Yr(e,r){r=ye(r),Ze(e,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:function(){},toWireType:function(u,c){}})}function Cn(){throw 1/0}var Kr={};function Qr(e){var r=Kr[e];return r===void 0?ye(e):r}function Dr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Zr(e){return e===0?vt.toHandle(Dr()):(e=Qr(e),vt.toHandle(Dr()[e]))}function An(e){e>4&&(Ae[e].refcount+=1)}function en(e,r){var u=gt[e];return u===void 0&&re(r+" has unknown type "+Ut(e)),u}function $n(e){for(var r="",u=0;u<e;++u)r+=(u!==0?", ":"")+"arg"+u;for(var c=()=>pe,v="return function emval_allocator_"+e+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,u=0;u<e;++u)v+="var argType"+u+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+u+`');
var arg`+u+" = argType"+u+`.readValueFromPointer(args);
args += argType`+u+`['argPackAdvance'];
argTypes += 4;
`;return v+="var obj = new constructor("+r+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",v)(en,t,vt.toHandle,c)}var xr={};function Rn(e,r,u,c){e=vt.toValue(e);var v=xr[r];return v||(v=$n(r),xr[r]=v),v(e,u,c)}function En(e,r){e=en(e,"_emval_take_value");var u=e.readValueFromPointer(r);return vt.toHandle(u)}function Sn(){we("")}function Fn(e,r,u){Z.copyWithin(e,r,r+u)}function Or(){return 2147483648}function kn(e){try{return ot.grow(e-ge.byteLength+65535>>>16),zt(ot.buffer),1}catch{}}function Ot(e){var r=Z.length;e=e>>>0;var u=Or();if(e>u)return!1;let c=(A,j)=>A+(j-A%j)%j;for(var v=1;v<=4;v*=2){var b=r*(1+.2/v);b=Math.min(b,e+100663296);var T=Math.min(u,c(Math.max(e,b),65536)),w=kn(T);if(w)return!0}return!1}var gr={};function Tt(){return N||"./this.program"}function Ht(){if(!Ht.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Tt()};for(var u in gr)gr[u]===void 0?delete r[u]:r[u]=gr[u];var c=[];for(var u in r)c.push(u+"="+r[u]);Ht.strings=c}return Ht.strings}function tn(e,r,u){for(var c=0;c<e.length;++c)ce[r++>>0]=e.charCodeAt(c);ce[r>>0]=0}function Ir(e,r){var u=0;return Ht().forEach(function(c,v){var b=r+u;pe[e+v*4>>2]=b,tn(c,b),u+=c.length+1}),0}function rn(e,r){var u=Ht();pe[e>>2]=u.length;var c=0;return u.forEach(function(v){c+=v.length+1}),pe[r>>2]=c,0}function yr(e){sn()||(t.onExit&&t.onExit(e),Xe=!0),V(e,new Pr(e))}function nn(e,r){yr(e)}var s=nn;function f(e){return 52}function h(e,r,u,c,v){return 70}var P=[null,[],[]];function $(e,r){var u=P[e];r===0||r===10?((e===1?oe:_e)(_r(u,0)),u.length=0):u.push(r)}function k(e,r,u,c){for(var v=0,b=0;b<u;b++){var T=pe[r>>2],w=pe[r+4>>2];r+=8;for(var A=0;A<w;A++)$(e,Z[T+A]);v+=w}return pe[c>>2]=v,0}function D(e){var r=t["_"+e];return r}function R(e,r){ce.set(e,r)}function O(e,r,u,c,v){var b={string:ue=>{var ve=0;if(ue!=null&&ue!==0){var it=(ue.length<<2)+1;ve=m(it),me(ue,ve,it)}return ve},array:ue=>{var ve=m(ue.length);return R(ue,ve),ve}};function T(ue){return r==="string"?Lt(ue):r==="boolean"?!!ue:ue}var w=D(e),A=[],j=0;if(c)for(var U=0;U<c.length;U++){var z=b[u[U]];z?(j===0&&(j=o()),A[U]=z(c[U])):A[U]=c[U]}var Y=w.apply(null,A);function he(ue){return j!==0&&p(j),T(ue)}return Y=he(Y),Y}yt=t.InternalError=Ne(Error,"InternalError"),xe(),_t=t.BindingError=Ne(Error,"BindingError"),$r(),Wr(),Lr(),pt=t.UnboundTypeError=Ne(Error,"UnboundTypeError"),Fr();var M={g:je,A:De,w:Dt,F:cr,u:zr,t:Ge,c:nr,E:nt,m:hn,b:ir,a:gn,l:kr,h:Jr,J:Tn,d:Xr,G:Yr,x:Cn,i:Nr,r:Zr,p:An,q:Rn,s:En,j:Sn,D:Fn,y:Ot,z:Ir,B:rn,I:s,C:f,v:h,k,o:x,n:i,H:n,f:I,e:E};Jt(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.L).apply(null,arguments)};var G=t._malloc=function(){return(G=t._malloc=t.asm.N).apply(null,arguments)},X=t._free=function(){return(X=t._free=t.asm.O).apply(null,arguments)},ee=t.___getTypeName=function(){return(ee=t.___getTypeName=t.asm.P).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm.Q).apply(null,arguments)};var a=t._setThrew=function(){return(a=t._setThrew=t.asm.R).apply(null,arguments)},o=t.stackSave=function(){return(o=t.stackSave=t.asm.S).apply(null,arguments)},p=t.stackRestore=function(){return(p=t.stackRestore=t.asm.T).apply(null,arguments)},m=t.stackAlloc=function(){return(m=t.stackAlloc=t.asm.U).apply(null,arguments)},C=t.___cxa_is_pointer_type=function(){return(C=t.___cxa_is_pointer_type=t.asm.V).apply(null,arguments)};t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.W).apply(null,arguments)};function I(e,r){var u=o();try{Fe(e)(r)}catch(c){if(p(u),c!==c+0)throw c;a(1,0)}}function x(e,r){var u=o();try{return Fe(e)(r)}catch(c){if(p(u),c!==c+0)throw c;a(1,0)}}function E(e,r,u,c){var v=o();try{Fe(e)(r,u,c)}catch(b){if(p(v),b!==b+0)throw b;a(1,0)}}function n(e,r,u,c){var v=o();try{return Fe(e)(r,u,c)}catch(b){if(p(v),b!==b+0)throw b;a(1,0)}}function i(e,r,u){var c=o();try{return Fe(e)(r,u)}catch(v){if(p(c),v!==v+0)throw v;a(1,0)}}t.ccall=O;var l;ut=function e(){l||g(),l||(ut=e)};function g(e){if(Be>0||(un(),Be>0))return;function r(){l||(l=!0,t.calledRun=!0,!Xe&&(Ft(),B(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),Ye()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),r()},1)):r()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return g(),S.ready}})();d.exports=_}(Gn)),Gn.exports}var qi=Ni(),Gi=Nn(qi);const Ji=new URL("/nifti-viewer/assets/libjpegturbowasm_decode-daqMmuVl.wasm",import.meta.url),Ln={codec:void 0,decoder:void 0};function Xi(){if(Ln.codec)return Promise.resolve();const d=Gi({locateFile:y=>y.endsWith(".wasm")?Ji.toString():y});return new Promise((y,_)=>{d.then(F=>{Ln.codec=F,Ln.decoder=new F.JPEGDecoder,y()},_)})}async function Yi(d,y){await Xi();const _=Ln.decoder;_.getEncodedBuffer(d.length).set(d),_.decode();const S=_.getFrameInfo(),t=_.getDecodedBuffer(),B={columns:S.width,rows:S.height,bitsPerPixel:S.bitsPerSample,signed:y.signed,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:S.componentCount},W=Ki(S,t),H={frameInfo:S};return{...y,pixelData:W,imageInfo:B,encodeOptions:H,...H,...B}}function Ki(d,y){return d.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}const Un={JpegImage:void 0,decodeConfig:{}};function Qi(d){return Un.decodeConfig=d,Un.JpegImage?Promise.resolve():new Promise((y,_)=>{import("./jpeg-HBGIxCW8.js").then(F=>{Un.JpegImage=F.default,y()}).catch(_)})}async function Zi(d,y){if(await Qi(),typeof Un.JpegImage>"u")throw new Error("No JPEG Baseline decoder loaded");const _=new Un.JpegImage;if(_.parse(y),_.colorTransform=!1,d.bitsAllocated===8)return d.pixelData=_.getData(d.columns,d.rows),d;if(d.bitsAllocated===16)return d.pixelData=_.getData16(d.columns,d.rows),d}const Wn={jpeg:void 0,decodeConfig:{}};function eo(d){return Wn.decodeConfig=d,Wn.jpeg?Promise.resolve():new Promise((y,_)=>{import("./lossless-BIYWXcdg.js").then(({Decoder:F})=>{const S=new F;Wn.jpeg=S,y()},_)})}async function oi(d,y){if(await eo(),typeof Wn.jpeg>"u")throw new Error("No JPEG Lossless decoder loaded");const _=d.bitsAllocated<=8?1:2,F=y.buffer,S=Wn.jpeg.decode(F,y.byteOffset,y.length,_);return d.pixelRepresentation===0?d.bitsAllocated===16?(d.pixelData=new Uint16Array(S.buffer),d):(d.pixelData=new Uint8Array(S.buffer),d):(d.pixelData=new Int16Array(S.buffer),d)}var Jn={exports:{}},ai;function to(){return ai||(ai=1,function(d,y){var _=(()=>{var F=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(F=F||__filename),function(S){S=S||{};var t=typeof S<"u"?S:{},B,W;t.ready=new Promise(function(s,f){B=s,W=f});var H=Object.assign({},t),N=typeof window=="object",V=typeof importScripts=="function",q=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",L="";function Q(s){return t.locateFile?t.locateFile(s,L):L+s}var J,te,ae;if(q){var Se=an,fe=an;V?L=fe.dirname(L)+"/":L=__dirname+"/",J=(s,f)=>(s=Gt(s)?new URL(s):fe.normalize(s),Se.readFileSync(s,f?void 0:"utf8")),ae=s=>{var f=J(s,!0);return f.buffer||(f=new Uint8Array(f)),f},te=(s,f,h)=>{s=Gt(s)?new URL(s):fe.normalize(s),Se.readFile(s,function(P,$){P?h(P):f($.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(s){if(!(s instanceof sr))throw s}),process.on("unhandledRejection",function(s){throw s}),t.inspect=function(){return"[Emscripten Module object]"}}else(N||V)&&(V?L=self.location.href:typeof document<"u"&&document.currentScript&&(L=document.currentScript.src),F&&(L=F),L.indexOf("blob:")!==0?L=L.substr(0,L.replace(/[?#].*/,"").lastIndexOf("/")+1):L="",J=s=>{var f=new XMLHttpRequest;return f.open("GET",s,!1),f.send(null),f.responseText},V&&(ae=s=>{var f=new XMLHttpRequest;return f.open("GET",s,!1),f.responseType="arraybuffer",f.send(null),new Uint8Array(f.response)}),te=(s,f,h)=>{var P=new XMLHttpRequest;P.open("GET",s,!0),P.responseType="arraybuffer",P.onload=()=>{if(P.status==200||P.status==0&&P.response){f(P.response);return}h()},P.onerror=h,P.send(null)});t.print||console.log.bind(console);var Ce=t.printErr||console.warn.bind(console);Object.assign(t,H),H=null,t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.quit&&t.quit;var be;t.wasmBinary&&(be=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&qt("no native wasm support detected");var oe,_e=!1;function Re(s,f){s||qt(f)}var ht=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function ot(s,f,h){for(var P=f+h,$=f;s[$]&&!($>=P);)++$;if($-f>16&&s.buffer&&ht)return ht.decode(s.subarray(f,$));for(var k="";f<$;){var D=s[f++];if(!(D&128)){k+=String.fromCharCode(D);continue}var R=s[f++]&63;if((D&224)==192){k+=String.fromCharCode((D&31)<<6|R);continue}var O=s[f++]&63;if((D&240)==224?D=(D&15)<<12|R<<6|O:D=(D&7)<<18|R<<12|O<<6|s[f++]&63,D<65536)k+=String.fromCharCode(D);else{var M=D-65536;k+=String.fromCharCode(55296|M>>10,56320|M&1023)}}return k}function Xe(s,f){return s?ot(me,s,f):""}function at(s,f,h,P){if(!(P>0))return 0;for(var $=h,k=h+P-1,D=0;D<s.length;++D){var R=s.charCodeAt(D);if(R>=55296&&R<=57343){var O=s.charCodeAt(++D);R=65536+((R&1023)<<10)|O&1023}if(R<=127){if(h>=k)break;f[h++]=R}else if(R<=2047){if(h+1>=k)break;f[h++]=192|R>>6,f[h++]=128|R&63}else if(R<=65535){if(h+2>=k)break;f[h++]=224|R>>12,f[h++]=128|R>>6&63,f[h++]=128|R&63}else{if(h+3>=k)break;f[h++]=240|R>>18,f[h++]=128|R>>12&63,f[h++]=128|R>>6&63,f[h++]=128|R&63}}return f[h]=0,h-$}function or(s,f,h){return at(s,me,f,h)}function _r(s){for(var f=0,h=0;h<s.length;++h){var P=s.charCodeAt(h);P<=127?f++:P<=2047?f+=2:P>=55296&&P<=57343?(f+=4,++h):f+=3}return f}var Lt,st,me,le,ge,ce,Z,ne,de;function Oe(s){Lt=s,t.HEAP8=st=new Int8Array(s),t.HEAP16=le=new Int16Array(s),t.HEAP32=ce=new Int32Array(s),t.HEAPU8=me=new Uint8Array(s),t.HEAPU16=ge=new Uint16Array(s),t.HEAPU32=Z=new Uint32Array(s),t.HEAPF32=ne=new Float32Array(s),t.HEAPF64=de=new Float64Array(s)}t.INITIAL_MEMORY;var pe,Vt=[],Bt=[],zt=[];function ar(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)Ur(t.preRun.shift());ke(Vt)}function mr(){ke(Bt)}function jr(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)un(t.postRun.shift());ke(zt)}function Ur(s){Vt.unshift(s)}function sn(s){Bt.unshift(s)}function un(s){zt.unshift(s)}var Ft=0,Ye=null;function Ke(s){Ft++,t.monitorRunDependencies&&t.monitorRunDependencies(Ft)}function Nt(s){if(Ft--,t.monitorRunDependencies&&t.monitorRunDependencies(Ft),Ft==0&&Ye){var f=Ye;Ye=null,f()}}function qt(s){t.onAbort&&t.onAbort(s),s="Aborted("+s+")",Ce(s),_e=!0,s+=". Build with -sASSERTIONS for more info.";var f=new WebAssembly.RuntimeError(s);throw W(f),f}var Be="data:application/octet-stream;base64,";function ut(s){return s.startsWith(Be)}function Gt(s){return s.startsWith("file://")}var Ee;Ee="charlswasm_decode.wasm",ut(Ee)||(Ee=Q(Ee));function we(s){try{if(s==Ee&&be)return new Uint8Array(be);if(ae)return ae(s);throw"both async and sync fetching of the wasm failed"}catch(f){qt(f)}}function Ie(){if(!be&&(N||V)){if(typeof fetch=="function"&&!Gt(Ee))return fetch(Ee,{credentials:"same-origin"}).then(function(s){if(!s.ok)throw"failed to load wasm binary file at '"+Ee+"'";return s.arrayBuffer()}).catch(function(){return we(Ee)});if(te)return new Promise(function(s,f){te(Ee,function(h){s(new Uint8Array(h))},f)})}return Promise.resolve().then(function(){return we(Ee)})}function br(){var s={a:kn};function f(D,R){var O=D.exports;t.asm=O,oe=t.asm.z,Oe(oe.buffer),pe=t.asm.C,sn(t.asm.A),Nt()}Ke();function h(D){f(D.instance)}function P(D){return Ie().then(function(R){return WebAssembly.instantiate(R,s)}).then(function(R){return R}).then(D,function(R){Ce("failed to asynchronously prepare wasm: "+R),qt(R)})}function $(){return!be&&typeof WebAssembly.instantiateStreaming=="function"&&!ut(Ee)&&!Gt(Ee)&&!q&&typeof fetch=="function"?fetch(Ee,{credentials:"same-origin"}).then(function(D){var R=WebAssembly.instantiateStreaming(D,s);return R.then(h,function(O){return Ce("wasm streaming compile failed: "+O),Ce("falling back to ArrayBuffer instantiation"),P(h)})}):P(h)}if(t.instantiateWasm)try{var k=t.instantiateWasm(s,f);return k}catch(D){Ce("Module.instantiateWasm callback failed with error: "+D),W(D)}return $().catch(W),{}}function sr(s){this.name="ExitStatus",this.message="Program terminated with exit("+s+")",this.status=s}function ke(s){for(;s.length>0;)s.shift()(t)}function ur(s){this.excPtr=s,this.ptr=s-24,this.set_type=function(f){Z[this.ptr+4>>2]=f},this.get_type=function(){return Z[this.ptr+4>>2]},this.set_destructor=function(f){Z[this.ptr+8>>2]=f},this.get_destructor=function(){return Z[this.ptr+8>>2]},this.set_refcount=function(f){ce[this.ptr>>2]=f},this.set_caught=function(f){f=f?1:0,st[this.ptr+12>>0]=f},this.get_caught=function(){return st[this.ptr+12>>0]!=0},this.set_rethrown=function(f){f=f?1:0,st[this.ptr+13>>0]=f},this.get_rethrown=function(){return st[this.ptr+13>>0]!=0},this.init=function(f,h){this.set_adjusted_ptr(0),this.set_type(f),this.set_destructor(h),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var f=ce[this.ptr>>2];ce[this.ptr>>2]=f+1},this.release_ref=function(){var f=ce[this.ptr>>2];return ce[this.ptr>>2]=f-1,f===1},this.set_adjusted_ptr=function(f){Z[this.ptr+16>>2]=f},this.get_adjusted_ptr=function(){return Z[this.ptr+16>>2]},this.get_exception_ptr=function(){var f=rn(this.get_type());if(f)return Z[this.excPtr>>2];var h=this.get_adjusted_ptr();return h!==0?h:this.excPtr}}function wr(s,f,h){var P=new ur(s);throw P.init(f,h),s}var Jt={};function Pr(s){for(;s.length;){var f=s.pop(),h=s.pop();h(f)}}function ft(s){return this.fromWireType(ce[s>>2])}var ze={},je={},Pe={},Ct=48,At=57;function Qe(s){if(s===void 0)return"_unknown";s=s.replace(/[^a-zA-Z0-9_]/g,"$");var f=s.charCodeAt(0);return f>=Ct&&f<=At?"_"+s:s}function gt(s,f){return s=Qe(s),new Function("body","return function "+s+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(f)}function $t(s,f){var h=gt(f,function(P){this.name=f,this.message=P;var $=new Error(P).stack;$!==void 0&&(this.stack=this.toString()+`
`+$.replace(/^Error(:[^\n]*)?\n/,""))});return h.prototype=Object.create(s.prototype),h.prototype.constructor=h,h.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},h}var fr=void 0;function jt(s){throw new fr(s)}function Me(s,f,h){s.forEach(function(R){Pe[R]=f});function P(R){var O=h(R);O.length!==s.length&&jt("Mismatched type converter count");for(var M=0;M<s.length;++M)xe(s[M],O[M])}var $=new Array(f.length),k=[],D=0;f.forEach((R,O)=>{je.hasOwnProperty(R)?$[O]=je[R]:(k.push(R),ze.hasOwnProperty(R)||(ze[R]=[]),ze[R].push(()=>{$[O]=je[R],++D,D===k.length&&P($)}))}),k.length===0&&P($)}function kt(s){var f=Jt[s];delete Jt[s];var h=f.rawConstructor,P=f.rawDestructor,$=f.fields,k=$.map(D=>D.getterReturnType).concat($.map(D=>D.setterArgumentType));Me([s],k,D=>{var R={};return $.forEach((O,M)=>{var G=O.fieldName,X=D[M],ee=O.getter,a=O.getterContext,o=D[M+$.length],p=O.setter,m=O.setterContext;R[G]={read:C=>X.fromWireType(ee(a,C)),write:(C,I)=>{var x=[];p(m,C,o.toWireType(x,I)),Pr(x)}}}),[{name:f.name,fromWireType:function(O){var M={};for(var G in R)M[G]=R[G].read(O);return P(O),M},toWireType:function(O,M){for(var G in R)if(!(G in M))throw new TypeError('Missing field:  "'+G+'"');var X=h();for(G in R)R[G].write(X,M[G]);return O!==null&&O.push(P,X),X},argPackAdvance:8,readValueFromPointer:ft,destructorFunction:P}]})}function Ne(s,f,h,P,$){}function yt(s){switch(s){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+s)}}function ct(){for(var s=new Array(256),f=0;f<256;++f)s[f]=String.fromCharCode(f);qe=s}var qe=void 0;function De(s){for(var f="",h=s;me[h];)f+=qe[me[h++]];return f}var Dt=void 0;function K(s){throw new Dt(s)}function xe(s,f,h={}){if(!("argPackAdvance"in f))throw new TypeError("registerType registeredInstance requires argPackAdvance");var P=f.name;if(s||K('type "'+P+'" must have a positive integer typeid pointer'),je.hasOwnProperty(s)){if(h.ignoreDuplicateRegistrations)return;K("Cannot register type '"+P+"' twice")}if(je[s]=f,delete Pe[s],ze.hasOwnProperty(s)){var $=ze[s];delete ze[s],$.forEach(k=>k())}}function ie(s,f,h,P,$){var k=yt(h);f=De(f),xe(s,{name:f,fromWireType:function(D){return!!D},toWireType:function(D,R){return R?P:$},argPackAdvance:8,readValueFromPointer:function(D){var R;if(h===1)R=st;else if(h===2)R=le;else if(h===4)R=ce;else throw new TypeError("Unknown boolean type size: "+f);return this.fromWireType(R[D>>k])},destructorFunction:null})}function ye(s){if(!(this instanceof St)||!(s instanceof St))return!1;for(var f=this.$$.ptrType.registeredClass,h=this.$$.ptr,P=s.$$.ptrType.registeredClass,$=s.$$.ptr;f.baseClass;)h=f.upcast(h),f=f.baseClass;for(;P.baseClass;)$=P.upcast($),P=P.baseClass;return f===P&&h===$}function _t(s){return{count:s.count,deleteScheduled:s.deleteScheduled,preservePointerOnDelete:s.preservePointerOnDelete,ptr:s.ptr,ptrType:s.ptrType,smartPtr:s.smartPtr,smartPtrType:s.smartPtrType}}function re(s){function f(h){return h.$$.ptrType.registeredClass.name}K(f(s)+" instance already deleted")}var Ze=!1;function cr(s){}function Xt(s){s.smartPtr?s.smartPtrType.rawDestructor(s.smartPtr):s.ptrType.registeredClass.rawDestructor(s.ptr)}function Tr(s){s.count.value-=1;var f=s.count.value===0;f&&Xt(s)}function Yt(s,f,h){if(f===h)return s;if(h.baseClass===void 0)return null;var P=Yt(s,f,h.baseClass);return P===null?null:h.downcast(P)}var $e={};function Rt(){return Object.keys(et).length}function se(){var s=[];for(var f in et)et.hasOwnProperty(f)&&s.push(et[f]);return s}var Ue=[];function lr(){for(;Ue.length;){var s=Ue.pop();s.$$.deleteScheduled=!1,s.delete()}}var lt=void 0;function Cr(s){lt=s,Ue.length&&lt&&lt(lr)}function xt(){t.getInheritedInstanceCount=Rt,t.getLiveInheritedInstances=se,t.flushPendingDeletes=lr,t.setDelayFunction=Cr}var et={};function dr(s,f){for(f===void 0&&K("ptr should not be undefined");s.baseClass;)f=s.upcast(f),s=s.baseClass;return f}function mt(s,f){return f=dr(s,f),et[f]}function Kt(s,f){(!f.ptrType||!f.ptr)&&jt("makeClassHandle requires ptr and ptrType");var h=!!f.smartPtrType,P=!!f.smartPtr;return h!==P&&jt("Both smartPtrType and smartPtr must be specified"),f.count={value:1},Le(Object.create(s,{$$:{value:f}}))}function Wr(s){var f=this.getPointee(s);if(!f)return this.destructor(s),null;var h=mt(this.registeredClass,f);if(h!==void 0){if(h.$$.count.value===0)return h.$$.ptr=f,h.$$.smartPtr=s,h.clone();var P=h.clone();return this.destructor(s),P}function $(){return this.isSmartPointer?Kt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:f,smartPtrType:this,smartPtr:s}):Kt(this.registeredClass.instancePrototype,{ptrType:this,ptr:s})}var k=this.registeredClass.getActualType(f),D=$e[k];if(!D)return $.call(this);var R;this.isConst?R=D.constPointerType:R=D.pointerType;var O=Yt(f,this.registeredClass,R.registeredClass);return O===null?$.call(this):this.isSmartPointer?Kt(R.registeredClass.instancePrototype,{ptrType:R,ptr:O,smartPtrType:this,smartPtr:s}):Kt(R.registeredClass.instancePrototype,{ptrType:R,ptr:O})}function Le(s){return typeof FinalizationRegistry>"u"?(Le=f=>f,s):(Ze=new FinalizationRegistry(f=>{Tr(f.$$)}),Le=f=>{var h=f.$$,P=!!h.smartPtr;if(P){var $={$$:h};Ze.register(f,$,f)}return f},cr=f=>Ze.unregister(f),Le(s))}function fn(){if(this.$$.ptr||re(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var s=Le(Object.create(Object.getPrototypeOf(this),{$$:{value:_t(this.$$)}}));return s.$$.count.value+=1,s.$$.deleteScheduled=!1,s}function Qt(){this.$$.ptr||re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&K("Object already scheduled for deletion"),cr(this),Tr(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Et(){return!this.$$.ptr}function Ar(){return this.$$.ptr||re(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&K("Object already scheduled for deletion"),Ue.push(this),Ue.length===1&&lt&&lt(lr),this.$$.deleteScheduled=!0,this}function bt(){St.prototype.isAliasOf=ye,St.prototype.clone=fn,St.prototype.delete=Qt,St.prototype.isDeleted=Et,St.prototype.deleteLater=Ar}function St(){}function Hr(s,f,h){if(s[f].overloadTable===void 0){var P=s[f];s[f]=function(){return s[f].overloadTable.hasOwnProperty(arguments.length)||K("Function '"+h+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+s[f].overloadTable+")!"),s[f].overloadTable[arguments.length].apply(this,arguments)},s[f].overloadTable=[],s[f].overloadTable[P.argCount]=P}}function Ve(s,f,h){t.hasOwnProperty(s)?((h===void 0||t[s].overloadTable!==void 0&&t[s].overloadTable[h]!==void 0)&&K("Cannot register public name '"+s+"' twice"),Hr(t,s,s),t.hasOwnProperty(h)&&K("Cannot register multiple overloads of a function with the same number of arguments ("+h+")!"),t[s].overloadTable[h]=f):(t[s]=f,h!==void 0&&(t[s].numArguments=h))}function Mr(s,f,h,P,$,k,D,R){this.name=s,this.constructor=f,this.instancePrototype=h,this.rawDestructor=P,this.baseClass=$,this.getActualType=k,this.upcast=D,this.downcast=R,this.pureVirtualFunctions=[]}function $r(s,f,h){for(;f!==h;)f.upcast||K("Expected null or instance of "+h.name+", got an instance of "+f.name),s=f.upcast(s),f=f.baseClass;return s}function tt(s,f){if(f===null)return this.isReference&&K("null is not a valid "+this.name),0;f.$$||K('Cannot pass "'+Je(f)+'" as a '+this.name),f.$$.ptr||K("Cannot pass deleted object as a pointer of type "+this.name);var h=f.$$.ptrType.registeredClass,P=$r(f.$$.ptr,h,this.registeredClass);return P}function pr(s,f){var h;if(f===null)return this.isReference&&K("null is not a valid "+this.name),this.isSmartPointer?(h=this.rawConstructor(),s!==null&&s.push(this.rawDestructor,h),h):0;f.$$||K('Cannot pass "'+Je(f)+'" as a '+this.name),f.$$.ptr||K("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&f.$$.ptrType.isConst&&K("Cannot convert argument of type "+(f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name)+" to parameter type "+this.name);var P=f.$$.ptrType.registeredClass;if(h=$r(f.$$.ptr,P,this.registeredClass),this.isSmartPointer)switch(f.$$.smartPtr===void 0&&K("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:f.$$.smartPtrType===this?h=f.$$.smartPtr:K("Cannot convert argument of type "+(f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:h=f.$$.smartPtr;break;case 2:if(f.$$.smartPtrType===this)h=f.$$.smartPtr;else{var $=f.clone();h=this.rawShare(h,Ae.toHandle(function(){$.delete()})),s!==null&&s.push(this.rawDestructor,h)}break;default:K("Unsupporting sharing policy")}return h}function Zt(s,f){if(f===null)return this.isReference&&K("null is not a valid "+this.name),0;f.$$||K('Cannot pass "'+Je(f)+'" as a '+this.name),f.$$.ptr||K("Cannot pass deleted object as a pointer of type "+this.name),f.$$.ptrType.isConst&&K("Cannot convert argument of type "+f.$$.ptrType.name+" to parameter type "+this.name);var h=f.$$.ptrType.registeredClass,P=$r(f.$$.ptr,h,this.registeredClass);return P}function cn(s){return this.rawGetPointee&&(s=this.rawGetPointee(s)),s}function Rr(s){this.rawDestructor&&this.rawDestructor(s)}function ln(s){s!==null&&s.delete()}function dn(){wt.prototype.getPointee=cn,wt.prototype.destructor=Rr,wt.prototype.argPackAdvance=8,wt.prototype.readValueFromPointer=ft,wt.prototype.deleteObject=ln,wt.prototype.fromWireType=Wr}function wt(s,f,h,P,$,k,D,R,O,M,G){this.name=s,this.registeredClass=f,this.isReference=h,this.isConst=P,this.isSmartPointer=$,this.pointeeType=k,this.sharingPolicy=D,this.rawGetPointee=R,this.rawConstructor=O,this.rawShare=M,this.rawDestructor=G,!$&&f.baseClass===void 0?P?(this.toWireType=tt,this.destructorFunction=null):(this.toWireType=Zt,this.destructorFunction=null):this.toWireType=pr}function Pt(s,f,h){t.hasOwnProperty(s)||jt("Replacing nonexistant public symbol"),t[s].overloadTable!==void 0&&h!==void 0?t[s].overloadTable[h]=f:(t[s]=f,t[s].argCount=h)}function dt(s,f,h){var P=t["dynCall_"+s];return h&&h.length?P.apply(null,[f].concat(h)):P.call(null,f)}var er=[];function Lr(s){var f=er[s];return f||(s>=er.length&&(er.length=s+1),er[s]=f=pe.get(s)),f}function We(s,f,h){if(s.includes("j"))return dt(s,f,h);var P=Lr(f).apply(null,h);return P}function Vr(s,f){var h=[];return function(){return h.length=0,Object.assign(h,arguments),We(s,f,h)}}function rt(s,f){s=De(s);function h(){return s.includes("j")?Vr(s,f):Lr(f)}var P=h();return typeof P!="function"&&K("unknown function pointer with signature "+s+": "+f),P}var tr=void 0;function Fe(s){var f=gr(s),h=De(f);return Tt(f),h}function rr(s,f){var h=[],P={};function $(k){if(!P[k]&&!je[k]){if(Pe[k]){Pe[k].forEach($);return}h.push(k),P[k]=!0}}throw f.forEach($),new tr(s+": "+h.map(Fe).join([", "]))}function Br(s,f,h,P,$,k,D,R,O,M,G,X,ee){G=De(G),k=rt($,k),R&&(R=rt(D,R)),M&&(M=rt(O,M)),ee=rt(X,ee);var a=Qe(G);Ve(a,function(){rr("Cannot construct "+G+" due to unbound types",[P])}),Me([s,f,h],P?[P]:[],function(o){o=o[0];var p,m;P?(p=o.registeredClass,m=p.instancePrototype):m=St.prototype;var C=gt(a,function(){if(Object.getPrototypeOf(this)!==I)throw new Dt("Use 'new' to construct "+G);if(x.constructor_body===void 0)throw new Dt(G+" has no accessible constructor");var l=x.constructor_body[arguments.length];if(l===void 0)throw new Dt("Tried to invoke ctor of "+G+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(x.constructor_body).toString()+") parameters instead!");return l.apply(this,arguments)}),I=Object.create(m,{constructor:{value:C}});C.prototype=I;var x=new Mr(G,C,I,ee,p,k,R,M),E=new wt(G,x,!0,!1,!1),n=new wt(G+"*",x,!1,!1,!1),i=new wt(G+" const*",x,!1,!0,!1);return $e[s]={pointerType:n,constPointerType:i},Pt(a,C),[E,n,i]})}function He(s,f){for(var h=[],P=0;P<s;P++)h.push(Z[f+P*4>>2]);return h}function pt(s,f){if(!(s instanceof Function))throw new TypeError("new_ called with constructor type "+typeof s+" which is not a function");var h=gt(s.name||"unknownFunctionName",function(){});h.prototype=s.prototype;var P=new h,$=s.apply(P,f);return $ instanceof Object?$:P}function Ut(s,f,h,P,$){var k=f.length;k<2&&K("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var D=f[1]!==null&&h!==null,R=!1,O=1;O<f.length;++O)if(f[O]!==null&&f[O].destructorFunction===void 0){R=!0;break}for(var M=f[0].name!=="void",G="",X="",O=0;O<k-2;++O)G+=(O!==0?", ":"")+"arg"+O,X+=(O!==0?", ":"")+"arg"+O+"Wired";var ee="return function "+Qe(s)+"("+G+`) {
if (arguments.length !== `+(k-2)+`) {
throwBindingError('function `+s+" called with ' + arguments.length + ' arguments, expected "+(k-2)+` args!');
}
`;R&&(ee+=`var destructors = [];
`);var a=R?"destructors":"null",o=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],p=[K,P,$,Pr,f[0],f[1]];D&&(ee+="var thisWired = classParam.toWireType("+a+`, this);
`);for(var O=0;O<k-2;++O)ee+="var arg"+O+"Wired = argType"+O+".toWireType("+a+", arg"+O+"); // "+f[O+2].name+`
`,o.push("argType"+O),p.push(f[O+2]);if(D&&(X="thisWired"+(X.length>0?", ":"")+X),ee+=(M?"var rv = ":"")+"invoker(fn"+(X.length>0?", ":"")+X+`);
`,R)ee+=`runDestructors(destructors);
`;else for(var O=D?1:2;O<f.length;++O){var m=O===1?"thisWired":"arg"+(O-2)+"Wired";f[O].destructorFunction!==null&&(ee+=m+"_dtor("+m+"); // "+f[O].name+`
`,o.push(m+"_dtor"),p.push(f[O].destructorFunction))}M&&(ee+=`var ret = retType.fromWireType(rv);
return ret;
`),ee+=`}
`,o.push(ee);var C=pt(Function,o).apply(null,p);return C}function Er(s,f,h,P,$,k){Re(f>0);var D=He(f,h);$=rt(P,$),Me([],[s],function(R){R=R[0];var O="constructor "+R.name;if(R.registeredClass.constructor_body===void 0&&(R.registeredClass.constructor_body=[]),R.registeredClass.constructor_body[f-1]!==void 0)throw new Dt("Cannot register multiple constructors with identical number of parameters ("+(f-1)+") for class '"+R.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return R.registeredClass.constructor_body[f-1]=()=>{rr("Cannot construct "+R.name+" due to unbound types",D)},Me([],D,function(M){return M.splice(1,0,null),R.registeredClass.constructor_body[f-1]=Ut(O,M,null,$,k),[]}),[]})}function zr(s,f,h,P,$,k,D,R){var O=He(h,P);f=De(f),k=rt($,k),Me([],[s],function(M){M=M[0];var G=M.name+"."+f;f.startsWith("@@")&&(f=Symbol[f.substring(2)]),R&&M.registeredClass.pureVirtualFunctions.push(f);function X(){rr("Cannot call "+G+" due to unbound types",O)}var ee=M.registeredClass.instancePrototype,a=ee[f];return a===void 0||a.overloadTable===void 0&&a.className!==M.name&&a.argCount===h-2?(X.argCount=h-2,X.className=M.name,ee[f]=X):(Hr(ee,f,G),ee[f].overloadTable[h-2]=X),Me([],O,function(o){var p=Ut(G,o,M,k,D);return ee[f].overloadTable===void 0?(p.argCount=h-2,ee[f]=p):ee[f].overloadTable[h-2]=p,[]}),[]})}var vr=[],Te=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Wt(s){s>4&&--Te[s].refcount===0&&(Te[s]=void 0,vr.push(s))}function Ge(){for(var s=0,f=5;f<Te.length;++f)Te[f]!==void 0&&++s;return s}function nr(){for(var s=5;s<Te.length;++s)if(Te[s]!==void 0)return Te[s];return null}function Sr(){t.count_emval_handles=Ge,t.get_first_emval=nr}var Ae={toValue:s=>(s||K("Cannot use deleted val. handle = "+s),Te[s].value),toHandle:s=>{switch(s){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var f=vr.length?vr.pop():Te.length;return Te[f]={refcount:1,value:s},f}}}};function Nr(s,f){f=De(f),xe(s,{name:f,fromWireType:function(h){var P=Ae.toValue(h);return Wt(h),P},toWireType:function(h,P){return Ae.toHandle(P)},argPackAdvance:8,readValueFromPointer:ft,destructorFunction:null})}function Je(s){if(s===null)return"null";var f=typeof s;return f==="object"||f==="array"||f==="function"?s.toString():""+s}function pn(s,f){switch(f){case 2:return function(h){return this.fromWireType(ne[h>>2])};case 3:return function(h){return this.fromWireType(de[h>>3])};default:throw new TypeError("Unknown float type: "+s)}}function Fr(s,f,h){var P=yt(h);f=De(f),xe(s,{name:f,fromWireType:function($){return $},toWireType:function($,k){return k},argPackAdvance:8,readValueFromPointer:pn(f,P),destructorFunction:null})}function vt(s,f,h,P,$,k){var D=He(f,h);s=De(s),$=rt(P,$),Ve(s,function(){rr("Cannot call "+s+" due to unbound types",D)},f-1),Me([],D,function(R){var O=[R[0],null].concat(R.slice(1));return Pt(s,Ut(s,O,null,$,k),f-1),[]})}function nt(s,f,h){switch(f){case 0:return h?function($){return st[$]}:function($){return me[$]};case 1:return h?function($){return le[$>>1]}:function($){return ge[$>>1]};case 2:return h?function($){return ce[$>>2]}:function($){return Z[$>>2]};default:throw new TypeError("Unknown integer type: "+s)}}function hr(s,f,h,P,$){f=De(f);var k=yt(h),D=X=>X;if(P===0){var R=32-8*h;D=X=>X<<R>>>R}var O=f.includes("unsigned"),M=(X,ee)=>{},G;O?G=function(X,ee){return M(ee,this.name),ee>>>0}:G=function(X,ee){return M(ee,this.name),ee},xe(s,{name:f,fromWireType:D,toWireType:G,argPackAdvance:8,readValueFromPointer:nt(f,k,P!==0),destructorFunction:null})}function vn(s,f,h){var P=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],$=P[f];function k(D){D=D>>2;var R=Z,O=R[D],M=R[D+1];return new $(Lt,M,O)}h=De(h),xe(s,{name:h,fromWireType:k,argPackAdvance:8,readValueFromPointer:k},{ignoreDuplicateRegistrations:!0})}function hn(s,f){f=De(f);var h=f==="std::string";xe(s,{name:f,fromWireType:function(P){var $=Z[P>>2],k=P+4,D;if(h)for(var R=k,O=0;O<=$;++O){var M=k+O;if(O==$||me[M]==0){var G=M-R,X=Xe(R,G);D===void 0?D=X:(D+="\0",D+=X),R=M+1}}else{for(var ee=new Array($),O=0;O<$;++O)ee[O]=String.fromCharCode(me[k+O]);D=ee.join("")}return Tt(P),D},toWireType:function(P,$){$ instanceof ArrayBuffer&&($=new Uint8Array($));var k,D=typeof $=="string";D||$ instanceof Uint8Array||$ instanceof Uint8ClampedArray||$ instanceof Int8Array||K("Cannot pass non-string to std::string"),h&&D?k=_r($):k=$.length;var R=Ot(4+k+1),O=R+4;if(Z[R>>2]=k,h&&D)or($,O,k+1);else if(D)for(var M=0;M<k;++M){var G=$.charCodeAt(M);G>255&&(Tt(O),K("String has UTF-16 code units that do not fit in 8 bits")),me[O+M]=G}else for(var M=0;M<k;++M)me[O+M]=$[M];return P!==null&&P.push(Tt,R),R},argPackAdvance:8,readValueFromPointer:ft,destructorFunction:function(P){Tt(P)}})}var qr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function ir(s,f){for(var h=s,P=h>>1,$=P+f/2;!(P>=$)&&ge[P];)++P;if(h=P<<1,h-s>32&&qr)return qr.decode(me.subarray(s,h));for(var k="",D=0;!(D>=f/2);++D){var R=le[s+D*2>>1];if(R==0)break;k+=String.fromCharCode(R)}return k}function gn(s,f,h){if(h===void 0&&(h=2147483647),h<2)return 0;h-=2;for(var P=f,$=h<s.length*2?h/2:s.length,k=0;k<$;++k){var D=s.charCodeAt(k);le[f>>1]=D,f+=2}return le[f>>1]=0,f-P}function kr(s){return s.length*2}function Gr(s,f){for(var h=0,P="";!(h>=f/4);){var $=ce[s+h*4>>2];if($==0)break;if(++h,$>=65536){var k=$-65536;P+=String.fromCharCode(55296|k>>10,56320|k&1023)}else P+=String.fromCharCode($)}return P}function yn(s,f,h){if(h===void 0&&(h=2147483647),h<4)return 0;for(var P=f,$=P+h-4,k=0;k<s.length;++k){var D=s.charCodeAt(k);if(D>=55296&&D<=57343){var R=s.charCodeAt(++k);D=65536+((D&1023)<<10)|R&1023}if(ce[f>>2]=D,f+=4,f+4>$)break}return ce[f>>2]=0,f-P}function _n(s){for(var f=0,h=0;h<s.length;++h){var P=s.charCodeAt(h);P>=55296&&P<=57343&&++h,f+=4}return f}function mn(s,f,h){h=De(h);var P,$,k,D,R;f===2?(P=ir,$=gn,D=kr,k=()=>ge,R=1):f===4&&(P=Gr,$=yn,D=_n,k=()=>Z,R=2),xe(s,{name:h,fromWireType:function(O){for(var M=Z[O>>2],G=k(),X,ee=O+4,a=0;a<=M;++a){var o=O+4+a*f;if(a==M||G[o>>R]==0){var p=o-ee,m=P(ee,p);X===void 0?X=m:(X+="\0",X+=m),ee=o+f}}return Tt(O),X},toWireType:function(O,M){typeof M!="string"&&K("Cannot pass non-string to C++ string type "+h);var G=D(M),X=Ot(4+G+f);return Z[X>>2]=G>>R,$(M,X+4,G+f),O!==null&&O.push(Tt,X),X},argPackAdvance:8,readValueFromPointer:ft,destructorFunction:function(O){Tt(O)}})}function bn(s,f,h,P,$,k){Jt[s]={name:De(f),rawConstructor:rt(h,P),rawDestructor:rt($,k),fields:[]}}function wn(s,f,h,P,$,k,D,R,O,M){Jt[s].fields.push({fieldName:De(f),getterReturnType:h,getter:rt(P,$),getterContext:k,setterArgumentType:D,setter:rt(R,O),setterContext:M})}function Pn(s,f){f=De(f),xe(s,{isVoid:!0,name:f,argPackAdvance:0,fromWireType:function(){},toWireType:function(h,P){}})}var Jr={};function Tn(s){var f=Jr[s];return f===void 0?De(s):f}function Xr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Yr(s){return s===0?Ae.toHandle(Xr()):(s=Tn(s),Ae.toHandle(Xr()[s]))}function Cn(s){s>4&&(Te[s].refcount+=1)}function Kr(s,f){var h=je[s];return h===void 0&&K(f+" has unknown type "+Fe(s)),h}function Qr(s){for(var f="",h=0;h<s;++h)f+=(h!==0?", ":"")+"arg"+h;for(var P=()=>Z,$="return function emval_allocator_"+s+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,h=0;h<s;++h)$+="var argType"+h+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+h+`');
var arg`+h+" = argType"+h+`.readValueFromPointer(args);
args += argType`+h+`['argPackAdvance'];
argTypes += 4;
`;return $+="var obj = new constructor("+f+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",$)(Kr,t,Ae.toHandle,P)}var Dr={};function Zr(s,f,h,P){s=Ae.toValue(s);var $=Dr[f];return $||($=Qr(f),Dr[f]=$),$(s,h,P)}function An(s,f){s=Kr(s,"_emval_take_value");var h=s.readValueFromPointer(f);return Ae.toHandle(h)}function en(){qt("")}function $n(s,f,h){me.copyWithin(s,f,f+h)}function xr(){return 2147483648}function Rn(s){try{return oe.grow(s-Lt.byteLength+65535>>>16),Oe(oe.buffer),1}catch{}}function En(s){var f=me.length;s=s>>>0;var h=xr();if(s>h)return!1;let P=(O,M)=>O+(M-O%M)%M;for(var $=1;$<=4;$*=2){var k=f*(1+.2/$);k=Math.min(k,s+100663296);var D=Math.min(h,P(Math.max(s,k),65536)),R=Rn(D);if(R)return!0}return!1}function Sn(s){var f=t["_"+s];return f}function Fn(s,f){st.set(s,f)}function Or(s,f,h,P,$){var k={string:o=>{var p=0;if(o!=null&&o!==0){var m=(o.length<<2)+1;p=Ir(m),or(o,p,m)}return p},array:o=>{var p=Ir(o.length);return Fn(o,p),p}};function D(o){return f==="string"?Xe(o):f==="boolean"?!!o:o}var R=Sn(s),O=[],M=0;if(P)for(var G=0;G<P.length;G++){var X=k[h[G]];X?(M===0&&(M=Ht()),O[G]=X(P[G])):O[G]=P[G]}var ee=R.apply(null,O);function a(o){return M!==0&&tn(M),D(o)}return ee=a(ee),ee}fr=t.InternalError=$t(Error,"InternalError"),ct(),Dt=t.BindingError=$t(Error,"BindingError"),bt(),xt(),dn(),tr=t.UnboundTypeError=$t(Error,"UnboundTypeError"),Sr();var kn={h:wr,q:kt,r:Ne,w:ie,p:Br,o:Er,c:zr,v:Nr,k:Fr,e:vt,b:hr,a:vn,j:hn,g:mn,u:bn,d:wn,x:Pn,i:Wt,m:Yr,l:Cn,y:Zr,n:An,f:en,t:$n,s:En};br(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.A).apply(null,arguments)};var Ot=t._malloc=function(){return(Ot=t._malloc=t.asm.B).apply(null,arguments)},gr=t.___getTypeName=function(){return(gr=t.___getTypeName=t.asm.D).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm.E).apply(null,arguments)};var Tt=t._free=function(){return(Tt=t._free=t.asm.F).apply(null,arguments)},Ht=t.stackSave=function(){return(Ht=t.stackSave=t.asm.G).apply(null,arguments)},tn=t.stackRestore=function(){return(tn=t.stackRestore=t.asm.H).apply(null,arguments)},Ir=t.stackAlloc=function(){return(Ir=t.stackAlloc=t.asm.I).apply(null,arguments)},rn=t.___cxa_is_pointer_type=function(){return(rn=t.___cxa_is_pointer_type=t.asm.J).apply(null,arguments)};t.ccall=Or;var yr;Ye=function s(){yr||nn(),yr||(Ye=s)};function nn(s){if(Ft>0||(ar(),Ft>0))return;function f(){yr||(yr=!0,t.calledRun=!0,!_e&&(mr(),B(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),jr()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),f()},1)):f()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return nn(),S.ready}})();d.exports=_}(Jn)),Jn.exports}var ro=to(),no=Nn(ro);const io=new URL("/nifti-viewer/assets/charlswasm_decode-484ovEoR.wasm",import.meta.url),On={codec:void 0,decoder:void 0,decodeConfig:{}};function oo(d){return typeof d=="number"?On.codec.getExceptionMessage(d):d}function ao(d){if(On.decodeConfig=d,On.codec)return Promise.resolve();const y=no({locateFile:_=>_.endsWith(".wasm")?io.toString():_});return new Promise((_,F)=>{y.then(S=>{On.codec=S,On.decoder=new S.JpegLSDecoder,_()},F)})}async function si(d,y){try{await ao();const _=On.decoder;_.getEncodedBuffer(d.length).set(d),_.decode();const S=_.getFrameInfo(),t=_.getInterleaveMode(),B=_.getNearLossless(),W=_.getDecodedBuffer(),H={columns:S.width,rows:S.height,bitsPerPixel:S.bitsPerSample,signed:y.signed,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:S.componentCount},N=so(S,W,y.signed),V={nearLossless:B,interleaveMode:t,frameInfo:S};return{...y,pixelData:N,imageInfo:H,encodeOptions:V,...V,...H}}catch(_){throw oo(_)}}function so(d,y,_){return d.bitsPerSample>8?_?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):_?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}var Xn={exports:{}},ui;function uo(){return ui||(ui=1,function(d,y){var _=(()=>{var F=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(F=F||__filename),function(S){S=S||{};var t=typeof S<"u"?S:{},B,W;t.ready=new Promise(function(a,o){B=a,W=o});var H=Object.assign({},t),N="./this.program",V=typeof window=="object",q=typeof importScripts=="function",L=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Q="";function J(a){return t.locateFile?t.locateFile(a,Q):Q+a}var te,ae,Se;if(L){var fe=an,Ce=an;q?Q=Ce.dirname(Q)+"/":Q=__dirname+"/",te=(a,o)=>(a=we(a)?new URL(a):Ce.normalize(a),fe.readFileSync(a,o?void 0:"utf8")),Se=a=>{var o=te(a,!0);return o.buffer||(o=new Uint8Array(o)),o},ae=(a,o,p)=>{a=we(a)?new URL(a):Ce.normalize(a),fe.readFile(a,function(m,C){m?p(m):o(C.buffer)})},process.argv.length>1&&(N=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(a){if(!(a instanceof ur))throw a}),process.on("unhandledRejection",function(a){throw a}),t.inspect=function(){return"[Emscripten Module object]"}}else(V||q)&&(q?Q=self.location.href:typeof document<"u"&&document.currentScript&&(Q=document.currentScript.src),F&&(Q=F),Q.indexOf("blob:")!==0?Q=Q.substr(0,Q.replace(/[?#].*/,"").lastIndexOf("/")+1):Q="",te=a=>{var o=new XMLHttpRequest;return o.open("GET",a,!1),o.send(null),o.responseText},q&&(Se=a=>{var o=new XMLHttpRequest;return o.open("GET",a,!1),o.responseType="arraybuffer",o.send(null),new Uint8Array(o.response)}),ae=(a,o,p)=>{var m=new XMLHttpRequest;m.open("GET",a,!0),m.responseType="arraybuffer",m.onload=()=>{if(m.status==200||m.status==0&&m.response){o(m.response);return}p()},m.onerror=p,m.send(null)});var be=t.print||console.log.bind(console),oe=t.printErr||console.warn.bind(console);Object.assign(t,H),H=null,t.arguments&&t.arguments,t.thisProgram&&(N=t.thisProgram),t.quit&&t.quit;var _e;t.wasmBinary&&(_e=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&ut("no native wasm support detected");var Re,ht=!1;function ot(a,o){a||ut(o)}var Xe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function at(a,o,p){for(var m=o+p,C=o;a[C]&&!(C>=m);)++C;if(C-o>16&&a.buffer&&Xe)return Xe.decode(a.subarray(o,C));for(var I="";o<C;){var x=a[o++];if(!(x&128)){I+=String.fromCharCode(x);continue}var E=a[o++]&63;if((x&224)==192){I+=String.fromCharCode((x&31)<<6|E);continue}var n=a[o++]&63;if((x&240)==224?x=(x&15)<<12|E<<6|n:x=(x&7)<<18|E<<12|n<<6|a[o++]&63,x<65536)I+=String.fromCharCode(x);else{var i=x-65536;I+=String.fromCharCode(55296|i>>10,56320|i&1023)}}return I}function or(a,o){return a?at(ge,a,o):""}function _r(a,o,p,m){if(!(m>0))return 0;for(var C=p,I=p+m-1,x=0;x<a.length;++x){var E=a.charCodeAt(x);if(E>=55296&&E<=57343){var n=a.charCodeAt(++x);E=65536+((E&1023)<<10)|n&1023}if(E<=127){if(p>=I)break;o[p++]=E}else if(E<=2047){if(p+1>=I)break;o[p++]=192|E>>6,o[p++]=128|E&63}else if(E<=65535){if(p+2>=I)break;o[p++]=224|E>>12,o[p++]=128|E>>6&63,o[p++]=128|E&63}else{if(p+3>=I)break;o[p++]=240|E>>18,o[p++]=128|E>>12&63,o[p++]=128|E>>6&63,o[p++]=128|E&63}}return o[p]=0,p-C}function Lt(a,o,p){return _r(a,ge,o,p)}function st(a){for(var o=0,p=0;p<a.length;++p){var m=a.charCodeAt(p);m<=127?o++:m<=2047?o+=2:m>=55296&&m<=57343?(o+=4,++p):o+=3}return o}var me,le,ge,ce,Z,ne,de,Oe,pe;function Vt(a){me=a,t.HEAP8=le=new Int8Array(a),t.HEAP16=ce=new Int16Array(a),t.HEAP32=ne=new Int32Array(a),t.HEAPU8=ge=new Uint8Array(a),t.HEAPU16=Z=new Uint16Array(a),t.HEAPU32=de=new Uint32Array(a),t.HEAPF32=Oe=new Float32Array(a),t.HEAPF64=pe=new Float64Array(a)}t.INITIAL_MEMORY;var Bt,zt=[],ar=[],mr=[];function jr(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)un(t.preRun.shift());wr(zt)}function Ur(){wr(ar)}function sn(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Ye(t.postRun.shift());wr(mr)}function un(a){zt.unshift(a)}function Ft(a){ar.unshift(a)}function Ye(a){mr.unshift(a)}var Ke=0,Nt=null;function qt(a){Ke++,t.monitorRunDependencies&&t.monitorRunDependencies(Ke)}function Be(a){if(Ke--,t.monitorRunDependencies&&t.monitorRunDependencies(Ke),Ke==0&&Nt){var o=Nt;Nt=null,o()}}function ut(a){t.onAbort&&t.onAbort(a),a="Aborted("+a+")",oe(a),ht=!0,a+=". Build with -sASSERTIONS for more info.";var o=new WebAssembly.RuntimeError(a);throw W(o),o}var Gt="data:application/octet-stream;base64,";function Ee(a){return a.startsWith(Gt)}function we(a){return a.startsWith("file://")}var Ie;Ie="openjpegwasm_decode.wasm",Ee(Ie)||(Ie=J(Ie));function br(a){try{if(a==Ie&&_e)return new Uint8Array(_e);if(Se)return Se(a);throw"both async and sync fetching of the wasm failed"}catch(o){ut(o)}}function sr(){if(!_e&&(V||q)){if(typeof fetch=="function"&&!we(Ie))return fetch(Ie,{credentials:"same-origin"}).then(function(a){if(!a.ok)throw"failed to load wasm binary file at '"+Ie+"'";return a.arrayBuffer()}).catch(function(){return br(Ie)});if(ae)return new Promise(function(a,o){ae(Ie,function(p){a(new Uint8Array(p))},o)})}return Promise.resolve().then(function(){return br(Ie)})}function ke(){var a={a:P};function o(x,E){var n=x.exports;t.asm=n,Re=t.asm.E,Vt(Re.buffer),Bt=t.asm.G,Ft(t.asm.F),Be()}qt();function p(x){o(x.instance)}function m(x){return sr().then(function(E){return WebAssembly.instantiate(E,a)}).then(function(E){return E}).then(x,function(E){oe("failed to asynchronously prepare wasm: "+E),ut(E)})}function C(){return!_e&&typeof WebAssembly.instantiateStreaming=="function"&&!Ee(Ie)&&!we(Ie)&&!L&&typeof fetch=="function"?fetch(Ie,{credentials:"same-origin"}).then(function(x){var E=WebAssembly.instantiateStreaming(x,a);return E.then(p,function(n){return oe("wasm streaming compile failed: "+n),oe("falling back to ArrayBuffer instantiation"),m(p)})}):m(p)}if(t.instantiateWasm)try{var I=t.instantiateWasm(a,o);return I}catch(x){oe("Module.instantiateWasm callback failed with error: "+x),W(x)}return C().catch(W),{}}function ur(a){this.name="ExitStatus",this.message="Program terminated with exit("+a+")",this.status=a}function wr(a){for(;a.length>0;)a.shift()(t)}function Jt(a){this.excPtr=a,this.ptr=a-24,this.set_type=function(o){de[this.ptr+4>>2]=o},this.get_type=function(){return de[this.ptr+4>>2]},this.set_destructor=function(o){de[this.ptr+8>>2]=o},this.get_destructor=function(){return de[this.ptr+8>>2]},this.set_refcount=function(o){ne[this.ptr>>2]=o},this.set_caught=function(o){o=o?1:0,le[this.ptr+12>>0]=o},this.get_caught=function(){return le[this.ptr+12>>0]!=0},this.set_rethrown=function(o){o=o?1:0,le[this.ptr+13>>0]=o},this.get_rethrown=function(){return le[this.ptr+13>>0]!=0},this.init=function(o,p){this.set_adjusted_ptr(0),this.set_type(o),this.set_destructor(p),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var o=ne[this.ptr>>2];ne[this.ptr>>2]=o+1},this.release_ref=function(){var o=ne[this.ptr>>2];return ne[this.ptr>>2]=o-1,o===1},this.set_adjusted_ptr=function(o){de[this.ptr+16>>2]=o},this.get_adjusted_ptr=function(){return de[this.ptr+16>>2]},this.get_exception_ptr=function(){var o=G(this.get_type());if(o)return de[this.excPtr>>2];var p=this.get_adjusted_ptr();return p!==0?p:this.excPtr}}function Pr(a,o,p){var m=new Jt(a);throw m.init(o,p),a}var ft={};function ze(a){for(;a.length;){var o=a.pop(),p=a.pop();p(o)}}function je(a){return this.fromWireType(ne[a>>2])}var Pe={},Ct={},At={},Qe=48,gt=57;function $t(a){if(a===void 0)return"_unknown";a=a.replace(/[^a-zA-Z0-9_]/g,"$");var o=a.charCodeAt(0);return o>=Qe&&o<=gt?"_"+a:a}function fr(a,o){return a=$t(a),new Function("body","return function "+a+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(o)}function jt(a,o){var p=fr(o,function(m){this.name=o,this.message=m;var C=new Error(m).stack;C!==void 0&&(this.stack=this.toString()+`
`+C.replace(/^Error(:[^\n]*)?\n/,""))});return p.prototype=Object.create(a.prototype),p.prototype.constructor=p,p.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},p}var Me=void 0;function kt(a){throw new Me(a)}function Ne(a,o,p){a.forEach(function(E){At[E]=o});function m(E){var n=p(E);n.length!==a.length&&kt("Mismatched type converter count");for(var i=0;i<a.length;++i)ye(a[i],n[i])}var C=new Array(o.length),I=[],x=0;o.forEach((E,n)=>{Ct.hasOwnProperty(E)?C[n]=Ct[E]:(I.push(E),Pe.hasOwnProperty(E)||(Pe[E]=[]),Pe[E].push(()=>{C[n]=Ct[E],++x,x===I.length&&m(C)}))}),I.length===0&&m(C)}function yt(a){var o=ft[a];delete ft[a];var p=o.rawConstructor,m=o.rawDestructor,C=o.fields,I=C.map(x=>x.getterReturnType).concat(C.map(x=>x.setterArgumentType));Ne([a],I,x=>{var E={};return C.forEach((n,i)=>{var l=n.fieldName,g=x[i],e=n.getter,r=n.getterContext,u=x[i+C.length],c=n.setter,v=n.setterContext;E[l]={read:b=>g.fromWireType(e(r,b)),write:(b,T)=>{var w=[];c(v,b,u.toWireType(w,T)),ze(w)}}}),[{name:o.name,fromWireType:function(n){var i={};for(var l in E)i[l]=E[l].read(n);return m(n),i},toWireType:function(n,i){for(var l in E)if(!(l in i))throw new TypeError('Missing field:  "'+l+'"');var g=p();for(l in E)E[l].write(g,i[l]);return n!==null&&n.push(m,g),g},argPackAdvance:8,readValueFromPointer:je,destructorFunction:m}]})}function ct(a,o,p,m,C){}function qe(a){switch(a){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+a)}}function De(){for(var a=new Array(256),o=0;o<256;++o)a[o]=String.fromCharCode(o);Dt=a}var Dt=void 0;function K(a){for(var o="",p=a;ge[p];)o+=Dt[ge[p++]];return o}var xe=void 0;function ie(a){throw new xe(a)}function ye(a,o,p={}){if(!("argPackAdvance"in o))throw new TypeError("registerType registeredInstance requires argPackAdvance");var m=o.name;if(a||ie('type "'+m+'" must have a positive integer typeid pointer'),Ct.hasOwnProperty(a)){if(p.ignoreDuplicateRegistrations)return;ie("Cannot register type '"+m+"' twice")}if(Ct[a]=o,delete At[a],Pe.hasOwnProperty(a)){var C=Pe[a];delete Pe[a],C.forEach(I=>I())}}function _t(a,o,p,m,C){var I=qe(p);o=K(o),ye(a,{name:o,fromWireType:function(x){return!!x},toWireType:function(x,E){return E?m:C},argPackAdvance:8,readValueFromPointer:function(x){var E;if(p===1)E=le;else if(p===2)E=ce;else if(p===4)E=ne;else throw new TypeError("Unknown boolean type size: "+o);return this.fromWireType(E[x>>I])},destructorFunction:null})}function re(a){if(!(this instanceof Ve)||!(a instanceof Ve))return!1;for(var o=this.$$.ptrType.registeredClass,p=this.$$.ptr,m=a.$$.ptrType.registeredClass,C=a.$$.ptr;o.baseClass;)p=o.upcast(p),o=o.baseClass;for(;m.baseClass;)C=m.upcast(C),m=m.baseClass;return o===m&&p===C}function Ze(a){return{count:a.count,deleteScheduled:a.deleteScheduled,preservePointerOnDelete:a.preservePointerOnDelete,ptr:a.ptr,ptrType:a.ptrType,smartPtr:a.smartPtr,smartPtrType:a.smartPtrType}}function cr(a){function o(p){return p.$$.ptrType.registeredClass.name}ie(o(a)+" instance already deleted")}var Xt=!1;function Tr(a){}function Yt(a){a.smartPtr?a.smartPtrType.rawDestructor(a.smartPtr):a.ptrType.registeredClass.rawDestructor(a.ptr)}function $e(a){a.count.value-=1;var o=a.count.value===0;o&&Yt(a)}function Rt(a,o,p){if(o===p)return a;if(p.baseClass===void 0)return null;var m=Rt(a,o,p.baseClass);return m===null?null:p.downcast(m)}var se={};function Ue(){return Object.keys(mt).length}function lr(){var a=[];for(var o in mt)mt.hasOwnProperty(o)&&a.push(mt[o]);return a}var lt=[];function Cr(){for(;lt.length;){var a=lt.pop();a.$$.deleteScheduled=!1,a.delete()}}var xt=void 0;function et(a){xt=a,lt.length&&xt&&xt(Cr)}function dr(){t.getInheritedInstanceCount=Ue,t.getLiveInheritedInstances=lr,t.flushPendingDeletes=Cr,t.setDelayFunction=et}var mt={};function Kt(a,o){for(o===void 0&&ie("ptr should not be undefined");a.baseClass;)o=a.upcast(o),a=a.baseClass;return o}function Wr(a,o){return o=Kt(a,o),mt[o]}function Le(a,o){(!o.ptrType||!o.ptr)&&kt("makeClassHandle requires ptr and ptrType");var p=!!o.smartPtrType,m=!!o.smartPtr;return p!==m&&kt("Both smartPtrType and smartPtr must be specified"),o.count={value:1},Qt(Object.create(a,{$$:{value:o}}))}function fn(a){var o=this.getPointee(a);if(!o)return this.destructor(a),null;var p=Wr(this.registeredClass,o);if(p!==void 0){if(p.$$.count.value===0)return p.$$.ptr=o,p.$$.smartPtr=a,p.clone();var m=p.clone();return this.destructor(a),m}function C(){return this.isSmartPointer?Le(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:o,smartPtrType:this,smartPtr:a}):Le(this.registeredClass.instancePrototype,{ptrType:this,ptr:a})}var I=this.registeredClass.getActualType(o),x=se[I];if(!x)return C.call(this);var E;this.isConst?E=x.constPointerType:E=x.pointerType;var n=Rt(o,this.registeredClass,E.registeredClass);return n===null?C.call(this):this.isSmartPointer?Le(E.registeredClass.instancePrototype,{ptrType:E,ptr:n,smartPtrType:this,smartPtr:a}):Le(E.registeredClass.instancePrototype,{ptrType:E,ptr:n})}function Qt(a){return typeof FinalizationRegistry>"u"?(Qt=o=>o,a):(Xt=new FinalizationRegistry(o=>{$e(o.$$)}),Qt=o=>{var p=o.$$,m=!!p.smartPtr;if(m){var C={$$:p};Xt.register(o,C,o)}return o},Tr=o=>Xt.unregister(o),Qt(a))}function Et(){if(this.$$.ptr||cr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var a=Qt(Object.create(Object.getPrototypeOf(this),{$$:{value:Ze(this.$$)}}));return a.$$.count.value+=1,a.$$.deleteScheduled=!1,a}function Ar(){this.$$.ptr||cr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ie("Object already scheduled for deletion"),Tr(this),$e(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function bt(){return!this.$$.ptr}function St(){return this.$$.ptr||cr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&ie("Object already scheduled for deletion"),lt.push(this),lt.length===1&&xt&&xt(Cr),this.$$.deleteScheduled=!0,this}function Hr(){Ve.prototype.isAliasOf=re,Ve.prototype.clone=Et,Ve.prototype.delete=Ar,Ve.prototype.isDeleted=bt,Ve.prototype.deleteLater=St}function Ve(){}function Mr(a,o,p){if(a[o].overloadTable===void 0){var m=a[o];a[o]=function(){return a[o].overloadTable.hasOwnProperty(arguments.length)||ie("Function '"+p+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+a[o].overloadTable+")!"),a[o].overloadTable[arguments.length].apply(this,arguments)},a[o].overloadTable=[],a[o].overloadTable[m.argCount]=m}}function $r(a,o,p){t.hasOwnProperty(a)?(ie("Cannot register public name '"+a+"' twice"),Mr(t,a,a),t.hasOwnProperty(p)&&ie("Cannot register multiple overloads of a function with the same number of arguments ("+p+")!"),t[a].overloadTable[p]=o):t[a]=o}function tt(a,o,p,m,C,I,x,E){this.name=a,this.constructor=o,this.instancePrototype=p,this.rawDestructor=m,this.baseClass=C,this.getActualType=I,this.upcast=x,this.downcast=E,this.pureVirtualFunctions=[]}function pr(a,o,p){for(;o!==p;)o.upcast||ie("Expected null or instance of "+p.name+", got an instance of "+o.name),a=o.upcast(a),o=o.baseClass;return a}function Zt(a,o){if(o===null)return this.isReference&&ie("null is not a valid "+this.name),0;o.$$||ie('Cannot pass "'+Fr(o)+'" as a '+this.name),o.$$.ptr||ie("Cannot pass deleted object as a pointer of type "+this.name);var p=o.$$.ptrType.registeredClass,m=pr(o.$$.ptr,p,this.registeredClass);return m}function cn(a,o){var p;if(o===null)return this.isReference&&ie("null is not a valid "+this.name),this.isSmartPointer?(p=this.rawConstructor(),a!==null&&a.push(this.rawDestructor,p),p):0;o.$$||ie('Cannot pass "'+Fr(o)+'" as a '+this.name),o.$$.ptr||ie("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&o.$$.ptrType.isConst&&ie("Cannot convert argument of type "+(o.$$.smartPtrType?o.$$.smartPtrType.name:o.$$.ptrType.name)+" to parameter type "+this.name);var m=o.$$.ptrType.registeredClass;if(p=pr(o.$$.ptr,m,this.registeredClass),this.isSmartPointer)switch(o.$$.smartPtr===void 0&&ie("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:o.$$.smartPtrType===this?p=o.$$.smartPtr:ie("Cannot convert argument of type "+(o.$$.smartPtrType?o.$$.smartPtrType.name:o.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:p=o.$$.smartPtr;break;case 2:if(o.$$.smartPtrType===this)p=o.$$.smartPtr;else{var C=o.clone();p=this.rawShare(p,Je.toHandle(function(){C.delete()})),a!==null&&a.push(this.rawDestructor,p)}break;default:ie("Unsupporting sharing policy")}return p}function Rr(a,o){if(o===null)return this.isReference&&ie("null is not a valid "+this.name),0;o.$$||ie('Cannot pass "'+Fr(o)+'" as a '+this.name),o.$$.ptr||ie("Cannot pass deleted object as a pointer of type "+this.name),o.$$.ptrType.isConst&&ie("Cannot convert argument of type "+o.$$.ptrType.name+" to parameter type "+this.name);var p=o.$$.ptrType.registeredClass,m=pr(o.$$.ptr,p,this.registeredClass);return m}function ln(a){return this.rawGetPointee&&(a=this.rawGetPointee(a)),a}function dn(a){this.rawDestructor&&this.rawDestructor(a)}function wt(a){a!==null&&a.delete()}function Pt(){dt.prototype.getPointee=ln,dt.prototype.destructor=dn,dt.prototype.argPackAdvance=8,dt.prototype.readValueFromPointer=je,dt.prototype.deleteObject=wt,dt.prototype.fromWireType=fn}function dt(a,o,p,m,C,I,x,E,n,i,l){this.name=a,this.registeredClass=o,this.isReference=p,this.isConst=m,this.isSmartPointer=C,this.pointeeType=I,this.sharingPolicy=x,this.rawGetPointee=E,this.rawConstructor=n,this.rawShare=i,this.rawDestructor=l,!C&&o.baseClass===void 0?m?(this.toWireType=Zt,this.destructorFunction=null):(this.toWireType=Rr,this.destructorFunction=null):this.toWireType=cn}function er(a,o,p){t.hasOwnProperty(a)||kt("Replacing nonexistant public symbol"),t[a].overloadTable!==void 0&&p!==void 0||(t[a]=o,t[a].argCount=p)}function Lr(a,o,p){var m=t["dynCall_"+a];return p&&p.length?m.apply(null,[o].concat(p)):m.call(null,o)}var We=[];function Vr(a){var o=We[a];return o||(a>=We.length&&(We.length=a+1),We[a]=o=Bt.get(a)),o}function rt(a,o,p){if(a.includes("j"))return Lr(a,o,p);var m=Vr(o).apply(null,p);return m}function tr(a,o){var p=[];return function(){return p.length=0,Object.assign(p,arguments),rt(a,o,p)}}function Fe(a,o){a=K(a);function p(){return a.includes("j")?tr(a,o):Vr(o)}var m=p();return typeof m!="function"&&ie("unknown function pointer with signature "+a+": "+o),m}var rr=void 0;function Br(a){var o=D(a),p=K(o);return k(o),p}function He(a,o){var p=[],m={};function C(I){if(!m[I]&&!Ct[I]){if(At[I]){At[I].forEach(C);return}p.push(I),m[I]=!0}}throw o.forEach(C),new rr(a+": "+p.map(Br).join([", "]))}function pt(a,o,p,m,C,I,x,E,n,i,l,g,e){l=K(l),I=Fe(C,I),E&&(E=Fe(x,E)),i&&(i=Fe(n,i)),e=Fe(g,e);var r=$t(l);$r(r,function(){He("Cannot construct "+l+" due to unbound types",[m])}),Ne([a,o,p],m?[m]:[],function(u){u=u[0];var c,v;m?(c=u.registeredClass,v=c.instancePrototype):v=Ve.prototype;var b=fr(r,function(){if(Object.getPrototypeOf(this)!==T)throw new xe("Use 'new' to construct "+l);if(w.constructor_body===void 0)throw new xe(l+" has no accessible constructor");var z=w.constructor_body[arguments.length];if(z===void 0)throw new xe("Tried to invoke ctor of "+l+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(w.constructor_body).toString()+") parameters instead!");return z.apply(this,arguments)}),T=Object.create(v,{constructor:{value:b}});b.prototype=T;var w=new tt(l,b,T,e,c,I,E,i),A=new dt(l,w,!0,!1,!1),j=new dt(l+"*",w,!1,!1,!1),U=new dt(l+" const*",w,!1,!0,!1);return se[a]={pointerType:j,constPointerType:U},er(r,b),[A,j,U]})}function Ut(a,o){for(var p=[],m=0;m<a;m++)p.push(de[o+m*4>>2]);return p}function Er(a,o){if(!(a instanceof Function))throw new TypeError("new_ called with constructor type "+typeof a+" which is not a function");var p=fr(a.name||"unknownFunctionName",function(){});p.prototype=a.prototype;var m=new p,C=a.apply(m,o);return C instanceof Object?C:m}function zr(a,o,p,m,C){var I=o.length;I<2&&ie("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var x=o[1]!==null&&p!==null,E=!1,n=1;n<o.length;++n)if(o[n]!==null&&o[n].destructorFunction===void 0){E=!0;break}for(var i=o[0].name!=="void",l="",g="",n=0;n<I-2;++n)l+=(n!==0?", ":"")+"arg"+n,g+=(n!==0?", ":"")+"arg"+n+"Wired";var e="return function "+$t(a)+"("+l+`) {
if (arguments.length !== `+(I-2)+`) {
throwBindingError('function `+a+" called with ' + arguments.length + ' arguments, expected "+(I-2)+` args!');
}
`;E&&(e+=`var destructors = [];
`);var r=E?"destructors":"null",u=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],c=[ie,m,C,ze,o[0],o[1]];x&&(e+="var thisWired = classParam.toWireType("+r+`, this);
`);for(var n=0;n<I-2;++n)e+="var arg"+n+"Wired = argType"+n+".toWireType("+r+", arg"+n+"); // "+o[n+2].name+`
`,u.push("argType"+n),c.push(o[n+2]);if(x&&(g="thisWired"+(g.length>0?", ":"")+g),e+=(i?"var rv = ":"")+"invoker(fn"+(g.length>0?", ":"")+g+`);
`,E)e+=`runDestructors(destructors);
`;else for(var n=x?1:2;n<o.length;++n){var v=n===1?"thisWired":"arg"+(n-2)+"Wired";o[n].destructorFunction!==null&&(e+=v+"_dtor("+v+"); // "+o[n].name+`
`,u.push(v+"_dtor"),c.push(o[n].destructorFunction))}i&&(e+=`var ret = retType.fromWireType(rv);
return ret;
`),e+=`}
`,u.push(e);var b=Er(Function,u).apply(null,c);return b}function vr(a,o,p,m,C,I){ot(o>0);var x=Ut(o,p);C=Fe(m,C),Ne([],[a],function(E){E=E[0];var n="constructor "+E.name;if(E.registeredClass.constructor_body===void 0&&(E.registeredClass.constructor_body=[]),E.registeredClass.constructor_body[o-1]!==void 0)throw new xe("Cannot register multiple constructors with identical number of parameters ("+(o-1)+") for class '"+E.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return E.registeredClass.constructor_body[o-1]=()=>{He("Cannot construct "+E.name+" due to unbound types",x)},Ne([],x,function(i){return i.splice(1,0,null),E.registeredClass.constructor_body[o-1]=zr(n,i,null,C,I),[]}),[]})}function Te(a,o,p,m,C,I,x,E){var n=Ut(p,m);o=K(o),I=Fe(C,I),Ne([],[a],function(i){i=i[0];var l=i.name+"."+o;o.startsWith("@@")&&(o=Symbol[o.substring(2)]),E&&i.registeredClass.pureVirtualFunctions.push(o);function g(){He("Cannot call "+l+" due to unbound types",n)}var e=i.registeredClass.instancePrototype,r=e[o];return r===void 0||r.overloadTable===void 0&&r.className!==i.name&&r.argCount===p-2?(g.argCount=p-2,g.className=i.name,e[o]=g):(Mr(e,o,l),e[o].overloadTable[p-2]=g),Ne([],n,function(u){var c=zr(l,u,i,I,x);return e[o].overloadTable===void 0?(c.argCount=p-2,e[o]=c):e[o].overloadTable[p-2]=c,[]}),[]})}var Wt=[],Ge=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function nr(a){a>4&&--Ge[a].refcount===0&&(Ge[a]=void 0,Wt.push(a))}function Sr(){for(var a=0,o=5;o<Ge.length;++o)Ge[o]!==void 0&&++a;return a}function Ae(){for(var a=5;a<Ge.length;++a)if(Ge[a]!==void 0)return Ge[a];return null}function Nr(){t.count_emval_handles=Sr,t.get_first_emval=Ae}var Je={toValue:a=>(a||ie("Cannot use deleted val. handle = "+a),Ge[a].value),toHandle:a=>{switch(a){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var o=Wt.length?Wt.pop():Ge.length;return Ge[o]={refcount:1,value:a},o}}}};function pn(a,o){o=K(o),ye(a,{name:o,fromWireType:function(p){var m=Je.toValue(p);return nr(p),m},toWireType:function(p,m){return Je.toHandle(m)},argPackAdvance:8,readValueFromPointer:je,destructorFunction:null})}function Fr(a){if(a===null)return"null";var o=typeof a;return o==="object"||o==="array"||o==="function"?a.toString():""+a}function vt(a,o){switch(o){case 2:return function(p){return this.fromWireType(Oe[p>>2])};case 3:return function(p){return this.fromWireType(pe[p>>3])};default:throw new TypeError("Unknown float type: "+a)}}function nt(a,o,p){var m=qe(p);o=K(o),ye(a,{name:o,fromWireType:function(C){return C},toWireType:function(C,I){return I},argPackAdvance:8,readValueFromPointer:vt(o,m),destructorFunction:null})}function hr(a,o,p){switch(o){case 0:return p?function(C){return le[C]}:function(C){return ge[C]};case 1:return p?function(C){return ce[C>>1]}:function(C){return Z[C>>1]};case 2:return p?function(C){return ne[C>>2]}:function(C){return de[C>>2]};default:throw new TypeError("Unknown integer type: "+a)}}function vn(a,o,p,m,C){o=K(o);var I=qe(p),x=g=>g;if(m===0){var E=32-8*p;x=g=>g<<E>>>E}var n=o.includes("unsigned"),i=(g,e)=>{},l;n?l=function(g,e){return i(e,this.name),e>>>0}:l=function(g,e){return i(e,this.name),e},ye(a,{name:o,fromWireType:x,toWireType:l,argPackAdvance:8,readValueFromPointer:hr(o,I,m!==0),destructorFunction:null})}function hn(a,o,p){var m=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],C=m[o];function I(x){x=x>>2;var E=de,n=E[x],i=E[x+1];return new C(me,i,n)}p=K(p),ye(a,{name:p,fromWireType:I,argPackAdvance:8,readValueFromPointer:I},{ignoreDuplicateRegistrations:!0})}function qr(a,o){o=K(o);var p=o==="std::string";ye(a,{name:o,fromWireType:function(m){var C=de[m>>2],I=m+4,x;if(p)for(var E=I,n=0;n<=C;++n){var i=I+n;if(n==C||ge[i]==0){var l=i-E,g=or(E,l);x===void 0?x=g:(x+="\0",x+=g),E=i+1}}else{for(var e=new Array(C),n=0;n<C;++n)e[n]=String.fromCharCode(ge[I+n]);x=e.join("")}return k(m),x},toWireType:function(m,C){C instanceof ArrayBuffer&&(C=new Uint8Array(C));var I,x=typeof C=="string";x||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int8Array||ie("Cannot pass non-string to std::string"),p&&x?I=st(C):I=C.length;var E=$(4+I+1),n=E+4;if(de[E>>2]=I,p&&x)Lt(C,n,I+1);else if(x)for(var i=0;i<I;++i){var l=C.charCodeAt(i);l>255&&(k(n),ie("String has UTF-16 code units that do not fit in 8 bits")),ge[n+i]=l}else for(var i=0;i<I;++i)ge[n+i]=C[i];return m!==null&&m.push(k,E),E},argPackAdvance:8,readValueFromPointer:je,destructorFunction:function(m){k(m)}})}var ir=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function gn(a,o){for(var p=a,m=p>>1,C=m+o/2;!(m>=C)&&Z[m];)++m;if(p=m<<1,p-a>32&&ir)return ir.decode(ge.subarray(a,p));for(var I="",x=0;!(x>=o/2);++x){var E=ce[a+x*2>>1];if(E==0)break;I+=String.fromCharCode(E)}return I}function kr(a,o,p){if(p===void 0&&(p=2147483647),p<2)return 0;p-=2;for(var m=o,C=p<a.length*2?p/2:a.length,I=0;I<C;++I){var x=a.charCodeAt(I);ce[o>>1]=x,o+=2}return ce[o>>1]=0,o-m}function Gr(a){return a.length*2}function yn(a,o){for(var p=0,m="";!(p>=o/4);){var C=ne[a+p*4>>2];if(C==0)break;if(++p,C>=65536){var I=C-65536;m+=String.fromCharCode(55296|I>>10,56320|I&1023)}else m+=String.fromCharCode(C)}return m}function _n(a,o,p){if(p===void 0&&(p=2147483647),p<4)return 0;for(var m=o,C=m+p-4,I=0;I<a.length;++I){var x=a.charCodeAt(I);if(x>=55296&&x<=57343){var E=a.charCodeAt(++I);x=65536+((x&1023)<<10)|E&1023}if(ne[o>>2]=x,o+=4,o+4>C)break}return ne[o>>2]=0,o-m}function mn(a){for(var o=0,p=0;p<a.length;++p){var m=a.charCodeAt(p);m>=55296&&m<=57343&&++p,o+=4}return o}function bn(a,o,p){p=K(p);var m,C,I,x,E;o===2?(m=gn,C=kr,x=Gr,I=()=>Z,E=1):o===4&&(m=yn,C=_n,x=mn,I=()=>de,E=2),ye(a,{name:p,fromWireType:function(n){for(var i=de[n>>2],l=I(),g,e=n+4,r=0;r<=i;++r){var u=n+4+r*o;if(r==i||l[u>>E]==0){var c=u-e,v=m(e,c);g===void 0?g=v:(g+="\0",g+=v),e=u+o}}return k(n),g},toWireType:function(n,i){typeof i!="string"&&ie("Cannot pass non-string to C++ string type "+p);var l=x(i),g=$(4+l+o);return de[g>>2]=l>>E,C(i,g+4,l+o),n!==null&&n.push(k,g),g},argPackAdvance:8,readValueFromPointer:je,destructorFunction:function(n){k(n)}})}function wn(a,o,p,m,C,I){ft[a]={name:K(o),rawConstructor:Fe(p,m),rawDestructor:Fe(C,I),fields:[]}}function Pn(a,o,p,m,C,I,x,E,n,i){ft[a].fields.push({fieldName:K(o),getterReturnType:p,getter:Fe(m,C),getterContext:I,setterArgumentType:x,setter:Fe(E,n),setterContext:i})}function Jr(a,o){o=K(o),ye(a,{isVoid:!0,name:o,argPackAdvance:0,fromWireType:function(){},toWireType:function(p,m){}})}var Tn={};function Xr(a){var o=Tn[a];return o===void 0?K(a):o}function Yr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Cn(a){return a===0?Je.toHandle(Yr()):(a=Xr(a),Je.toHandle(Yr()[a]))}function Kr(a){a>4&&(Ge[a].refcount+=1)}function Qr(a,o){var p=Ct[a];return p===void 0&&ie(o+" has unknown type "+Br(a)),p}function Dr(a){for(var o="",p=0;p<a;++p)o+=(p!==0?", ":"")+"arg"+p;for(var m=()=>de,C="return function emval_allocator_"+a+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,p=0;p<a;++p)C+="var argType"+p+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+p+`');
var arg`+p+" = argType"+p+`.readValueFromPointer(args);
args += argType`+p+`['argPackAdvance'];
argTypes += 4;
`;return C+="var obj = new constructor("+o+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",C)(Qr,t,Je.toHandle,m)}var Zr={};function An(a,o,p,m){a=Je.toValue(a);var C=Zr[o];return C||(C=Dr(o),Zr[o]=C),C(a,p,m)}function en(a,o){a=Qr(a,"_emval_take_value");var p=a.readValueFromPointer(o);return Je.toHandle(p)}function $n(){ut("")}function xr(){return 2147483648}function Rn(){return xr()}function En(a,o,p){ge.copyWithin(a,o,o+p)}function Sn(a){try{return Re.grow(a-me.byteLength+65535>>>16),Vt(Re.buffer),1}catch{}}function Fn(a){var o=ge.length;a=a>>>0;var p=xr();if(a>p)return!1;let m=(n,i)=>n+(i-n%i)%i;for(var C=1;C<=4;C*=2){var I=o*(1+.2/C);I=Math.min(I,a+100663296);var x=Math.min(p,m(Math.max(a,I),65536)),E=Sn(x);if(E)return!0}return!1}var Or={};function kn(){return N||"./this.program"}function Ot(){if(!Ot.strings){var a=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",o={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:a,_:kn()};for(var p in Or)Or[p]===void 0?delete o[p]:o[p]=Or[p];var m=[];for(var p in o)m.push(p+"="+o[p]);Ot.strings=m}return Ot.strings}function gr(a,o,p){for(var m=0;m<a.length;++m)le[o++>>0]=a.charCodeAt(m);le[o>>0]=0}function Tt(a,o){var p=0;return Ot().forEach(function(m,C){var I=o+p;de[a+C*4>>2]=I,gr(m,I),p+=m.length+1}),0}function Ht(a,o){var p=Ot();de[a>>2]=p.length;var m=0;return p.forEach(function(C){m+=C.length+1}),de[o>>2]=m,0}function tn(a){return 52}function Ir(a,o,p,m,C){return 70}var rn=[null,[],[]];function yr(a,o){var p=rn[a];o===0||o===10?((a===1?be:oe)(at(p,0)),p.length=0):p.push(o)}function nn(a,o,p,m){for(var C=0,I=0;I<p;I++){var x=de[o>>2],E=de[o+4>>2];o+=8;for(var n=0;n<E;n++)yr(a,ge[x+n]);C+=E}return de[m>>2]=C,0}function s(a){var o=t["_"+a];return o}function f(a,o){le.set(a,o)}function h(a,o,p,m,C){var I={string:u=>{var c=0;if(u!=null&&u!==0){var v=(u.length<<2)+1;c=M(v),Lt(u,c,v)}return c},array:u=>{var c=M(u.length);return f(u,c),c}};function x(u){return o==="string"?or(u):o==="boolean"?!!u:u}var E=s(a),n=[],i=0;if(m)for(var l=0;l<m.length;l++){var g=I[p[l]];g?(i===0&&(i=R()),n[l]=g(m[l])):n[l]=m[l]}var e=E.apply(null,n);function r(u){return i!==0&&O(i),x(u)}return e=r(e),e}Me=t.InternalError=jt(Error,"InternalError"),De(),xe=t.BindingError=jt(Error,"BindingError"),Hr(),dr(),Pt(),rr=t.UnboundTypeError=jt(Error,"UnboundTypeError"),Nr();var P={D:Pr,e:yt,t:ct,B:_t,r:pt,q:vr,b:Te,A:pn,l:nt,d:vn,a:hn,k:qr,f:bn,g:wn,c:Pn,C:Jr,h:nr,o:Cn,m:Kr,n:An,p:en,i:$n,v:Rn,z:En,u:Fn,w:Tt,x:Ht,y:tn,s:Ir,j:nn};ke(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.F).apply(null,arguments)};var $=t._malloc=function(){return($=t._malloc=t.asm.H).apply(null,arguments)},k=t._free=function(){return(k=t._free=t.asm.I).apply(null,arguments)},D=t.___getTypeName=function(){return(D=t.___getTypeName=t.asm.J).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm.K).apply(null,arguments)};var R=t.stackSave=function(){return(R=t.stackSave=t.asm.L).apply(null,arguments)},O=t.stackRestore=function(){return(O=t.stackRestore=t.asm.M).apply(null,arguments)},M=t.stackAlloc=function(){return(M=t.stackAlloc=t.asm.N).apply(null,arguments)},G=t.___cxa_is_pointer_type=function(){return(G=t.___cxa_is_pointer_type=t.asm.O).apply(null,arguments)};t.dynCall_iji=function(){return(t.dynCall_iji=t.asm.P).apply(null,arguments)},t.dynCall_jji=function(){return(t.dynCall_jji=t.asm.Q).apply(null,arguments)},t.dynCall_iiji=function(){return(t.dynCall_iiji=t.asm.R).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.S).apply(null,arguments)},t.ccall=h;var X;Nt=function a(){X||ee(),X||(Nt=a)};function ee(a){if(Ke>0||(jr(),Ke>0))return;function o(){X||(X=!0,t.calledRun=!0,!ht&&(Ur(),B(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),sn()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),o()},1)):o()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return ee(),S.ready}})();d.exports=_}(Xn)),Xn.exports}var fo=uo(),co=Nn(fo);const lo=new URL("/nifti-viewer/assets/openjpegwasm_decode-C4nnCcr6.wasm",import.meta.url),In={codec:void 0,decoder:void 0,decodeConfig:{}};function po(d){if(In.decodeConfig=d,In.codec)return Promise.resolve();const y=co({locateFile:_=>_.endsWith(".wasm")?lo.toString():_});return new Promise((_,F)=>{y.then(S=>{In.codec=S,In.decoder=new S.J2KDecoder,_()},F)})}async function fi(d,y){await po();const _=In.decoder,F=_.getEncodedBuffer(d.length);F.set(d),_.decode();const S=_.getFrameInfo(),t=_.getDecodedBuffer();new Uint8Array(t.length).set(t);const W=`x: ${_.getImageOffset().x}, y: ${_.getImageOffset().y}`,H=_.getNumDecompositions(),N=_.getNumLayers(),V=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][_.getProgressionOrder()+1],q=_.getIsReversible(),L=`${_.getBlockDimensions().width} x ${_.getBlockDimensions().height}`,Q=`${_.getTileSize().width} x ${_.getTileSize().height}`,J=`${_.getTileOffset().x}, ${_.getTileOffset().y}`,te=_.getColorSpace(),ae=`${t.length.toLocaleString()} bytes`,Se=`${(t.length/F.length).toFixed(2)}:1`,fe={columns:S.width,rows:S.height,bitsPerPixel:S.bitsPerSample,signed:S.isSigned,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:S.componentCount},Ce=vo(S,t),be={imageOffset:W,numDecompositions:H,numLayers:N,progessionOrder:V,reversible:q,blockDimensions:L,tileSize:Q,tileOffset:J,colorTransform:te,decodedSize:ae,compressionRatio:Se};return{...y,pixelData:Ce,imageInfo:fe,encodeOptions:be,...be,...fe}}function vo(d,y){return d.bitsPerSample>8?d.isSigned?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):d.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}var Yn={exports:{}},ci;function ho(){return ci||(ci=1,function(d,y){var _=(()=>{var F=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(F=F||__filename),function(t){t=t||{};var t=typeof t<"u"?t:{},B,W;t.ready=new Promise(function(n,i){B=n,W=i});var H=Object.assign({},t),N=typeof window=="object",V=typeof importScripts=="function",q=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",L="";function Q(n){return t.locateFile?t.locateFile(n,L):L+n}var J,te,ae;if(q){var Se=an,fe=an;V?L=fe.dirname(L)+"/":L=__dirname+"/",J=(n,i)=>(n=Ee(n)?new URL(n):fe.normalize(n),Se.readFileSync(n,i?void 0:"utf8")),ae=n=>{var i=J(n,!0);return i.buffer||(i=new Uint8Array(i)),i},te=(n,i,l)=>{n=Ee(n)?new URL(n):fe.normalize(n),Se.readFile(n,function(g,e){g?l(g):i(e.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(n){if(!(n instanceof ke))throw n}),process.on("unhandledRejection",function(n){throw n}),t.inspect=function(){return"[Emscripten Module object]"}}else(N||V)&&(V?L=self.location.href:typeof document<"u"&&document.currentScript&&(L=document.currentScript.src),F&&(L=F),L.indexOf("blob:")!==0?L=L.substr(0,L.replace(/[?#].*/,"").lastIndexOf("/")+1):L="",J=n=>{var i=new XMLHttpRequest;return i.open("GET",n,!1),i.send(null),i.responseText},V&&(ae=n=>{var i=new XMLHttpRequest;return i.open("GET",n,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),te=(n,i,l)=>{var g=new XMLHttpRequest;g.open("GET",n,!0),g.responseType="arraybuffer",g.onload=()=>{if(g.status==200||g.status==0&&g.response){i(g.response);return}l()},g.onerror=l,g.send(null)});var Ce=t.print||console.log.bind(console),be=t.printErr||console.warn.bind(console);Object.assign(t,H),H=null,t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.quit&&t.quit;var oe;t.wasmBinary&&(oe=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&Be("no native wasm support detected");var _e,Re=!1;function ht(n,i){n||Be(i)}var ot=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Xe(n,i,l){for(var g=i+l,e=i;n[e]&&!(e>=g);)++e;if(e-i>16&&n.buffer&&ot)return ot.decode(n.subarray(i,e));for(var r="";i<e;){var u=n[i++];if(!(u&128)){r+=String.fromCharCode(u);continue}var c=n[i++]&63;if((u&224)==192){r+=String.fromCharCode((u&31)<<6|c);continue}var v=n[i++]&63;if((u&240)==224?u=(u&15)<<12|c<<6|v:u=(u&7)<<18|c<<12|v<<6|n[i++]&63,u<65536)r+=String.fromCharCode(u);else{var b=u-65536;r+=String.fromCharCode(55296|b>>10,56320|b&1023)}}return r}function at(n,i){return n?Xe(le,n,i):""}function or(n,i,l,g){if(!(g>0))return 0;for(var e=l,r=l+g-1,u=0;u<n.length;++u){var c=n.charCodeAt(u);if(c>=55296&&c<=57343){var v=n.charCodeAt(++u);c=65536+((c&1023)<<10)|v&1023}if(c<=127){if(l>=r)break;i[l++]=c}else if(c<=2047){if(l+1>=r)break;i[l++]=192|c>>6,i[l++]=128|c&63}else if(c<=65535){if(l+2>=r)break;i[l++]=224|c>>12,i[l++]=128|c>>6&63,i[l++]=128|c&63}else{if(l+3>=r)break;i[l++]=240|c>>18,i[l++]=128|c>>12&63,i[l++]=128|c>>6&63,i[l++]=128|c&63}}return i[l]=0,l-e}function _r(n,i,l){return or(n,le,i,l)}function Lt(n){for(var i=0,l=0;l<n.length;++l){var g=n.charCodeAt(l);g<=127?i++:g<=2047?i+=2:g>=55296&&g<=57343?(i+=4,++l):i+=3}return i}var st,me,le,ge,ce,Z,ne,de,Oe;function pe(n){st=n,t.HEAP8=me=new Int8Array(n),t.HEAP16=ge=new Int16Array(n),t.HEAP32=Z=new Int32Array(n),t.HEAPU8=le=new Uint8Array(n),t.HEAPU16=ce=new Uint16Array(n),t.HEAPU32=ne=new Uint32Array(n),t.HEAPF32=de=new Float32Array(n),t.HEAPF64=Oe=new Float64Array(n)}t.INITIAL_MEMORY;var Vt,Bt=[],zt=[],ar=[];function mr(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)sn(t.preRun.shift());ur(Bt)}function jr(){ur(zt)}function Ur(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)Ft(t.postRun.shift());ur(ar)}function sn(n){Bt.unshift(n)}function un(n){zt.unshift(n)}function Ft(n){ar.unshift(n)}var Ye=0,Ke=null;function Nt(n){Ye++,t.monitorRunDependencies&&t.monitorRunDependencies(Ye)}function qt(n){if(Ye--,t.monitorRunDependencies&&t.monitorRunDependencies(Ye),Ye==0&&Ke){var i=Ke;Ke=null,i()}}function Be(n){t.onAbort&&t.onAbort(n),n="Aborted("+n+")",be(n),Re=!0,n+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(n);throw W(i),i}var ut="data:application/octet-stream;base64,";function Gt(n){return n.startsWith(ut)}function Ee(n){return n.startsWith("file://")}var we;we="openjphjs.wasm",Gt(we)||(we=Q(we));function Ie(n){try{if(n==we&&oe)return new Uint8Array(oe);if(ae)return ae(n);throw"both async and sync fetching of the wasm failed"}catch(i){Be(i)}}function br(){if(!oe&&(N||V)){if(typeof fetch=="function"&&!Ee(we))return fetch(we,{credentials:"same-origin"}).then(function(n){if(!n.ok)throw"failed to load wasm binary file at '"+we+"'";return n.arrayBuffer()}).catch(function(){return Ie(we)});if(te)return new Promise(function(n,i){te(we,function(l){n(new Uint8Array(l))},i)})}return Promise.resolve().then(function(){return Ie(we)})}function sr(){var n={env:s,wasi_snapshot_preview1:s};function i(u,c){var v=u.exports;t.asm=v,_e=t.asm.memory,pe(_e.buffer),Vt=t.asm.__indirect_function_table,un(t.asm.__wasm_call_ctors),qt()}Nt();function l(u){i(u.instance)}function g(u){return br().then(function(c){return WebAssembly.instantiate(c,n)}).then(function(c){return c}).then(u,function(c){be("failed to asynchronously prepare wasm: "+c),Be(c)})}function e(){return!oe&&typeof WebAssembly.instantiateStreaming=="function"&&!Gt(we)&&!Ee(we)&&!q&&typeof fetch=="function"?fetch(we,{credentials:"same-origin"}).then(function(u){var c=WebAssembly.instantiateStreaming(u,n);return c.then(l,function(v){return be("wasm streaming compile failed: "+v),be("falling back to ArrayBuffer instantiation"),g(l)})}):g(l)}if(t.instantiateWasm)try{var r=t.instantiateWasm(n,i);return r}catch(u){be("Module.instantiateWasm callback failed with error: "+u),W(u)}return e().catch(W),{}}function ke(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}function ur(n){for(;n.length>0;)n.shift()(t)}function wr(n,i,l,g){Be("Assertion failed: "+at(n)+", at: "+[i?at(i):"unknown filename",l,g?at(g):"unknown function"])}var Jt=[];function Pr(n){n.add_ref()}function ft(n){var i=new Qe(n);return i.get_caught()||i.set_caught(!0),i.set_rethrown(!1),Jt.push(i),Pr(i),i.get_exception_ptr()}var ze=0,je=[];function Pe(n){var i=je[n];return i||(n>=je.length&&(je.length=n+1),je[n]=i=Vt.get(n)),i}function Ct(n){if(n.release_ref()&&!n.get_rethrown()){var i=n.get_destructor();i&&Pe(i)(n.excPtr),P(n.excPtr)}}function At(){_setThrew(0);var n=Jt.pop();Ct(n),ze=0}function Qe(n){this.excPtr=n,this.ptr=n-24,this.set_type=function(i){ne[this.ptr+4>>2]=i},this.get_type=function(){return ne[this.ptr+4>>2]},this.set_destructor=function(i){ne[this.ptr+8>>2]=i},this.get_destructor=function(){return ne[this.ptr+8>>2]},this.set_refcount=function(i){Z[this.ptr>>2]=i},this.set_caught=function(i){i=i?1:0,me[this.ptr+12>>0]=i},this.get_caught=function(){return me[this.ptr+12>>0]!=0},this.set_rethrown=function(i){i=i?1:0,me[this.ptr+13>>0]=i},this.get_rethrown=function(){return me[this.ptr+13>>0]!=0},this.init=function(i,l){this.set_adjusted_ptr(0),this.set_type(i),this.set_destructor(l),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var i=Z[this.ptr>>2];Z[this.ptr>>2]=i+1},this.release_ref=function(){var i=Z[this.ptr>>2];return Z[this.ptr>>2]=i-1,i===1},this.set_adjusted_ptr=function(i){ne[this.ptr+16>>2]=i},this.get_adjusted_ptr=function(){return ne[this.ptr+16>>2]},this.get_exception_ptr=function(){var i=G(this.get_type());if(i)return ne[this.excPtr>>2];var l=this.get_adjusted_ptr();return l!==0?l:this.excPtr}}function gt(n){throw ze||(ze=n),n}function $t(){var n=ze;if(!n)return k(0),0;var i=new Qe(n);i.set_adjusted_ptr(n);var l=i.get_type();if(!l)return k(0),n;for(var g=0;g<arguments.length;g++){var e=arguments[g];if(e===0||e===l)break;var r=i.ptr+16;if(M(e,l,r))return k(e),n}return k(l),n}function fr(){var n=ze;if(!n)return k(0),0;var i=new Qe(n);i.set_adjusted_ptr(n);var l=i.get_type();if(!l)return k(0),n;for(var g=0;g<arguments.length;g++){var e=arguments[g];if(e===0||e===l)break;var r=i.ptr+16;if(M(e,l,r))return k(e),n}return k(l),n}function jt(n,i,l){var g=new Qe(n);throw g.init(i,l),ze=n,n}var Me={};function kt(n){for(;n.length;){var i=n.pop(),l=n.pop();l(i)}}function Ne(n){return this.fromWireType(Z[n>>2])}var yt={},ct={},qe={},De=48,Dt=57;function K(n){if(n===void 0)return"_unknown";n=n.replace(/[^a-zA-Z0-9_]/g,"$");var i=n.charCodeAt(0);return i>=De&&i<=Dt?"_"+n:n}function xe(n,i){return n=K(n),new Function("body","return function "+n+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(i)}function ie(n,i){var l=xe(i,function(g){this.name=i,this.message=g;var e=new Error(g).stack;e!==void 0&&(this.stack=this.toString()+`
`+e.replace(/^Error(:[^\n]*)?\n/,""))});return l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},l}var ye=void 0;function _t(n){throw new ye(n)}function re(n,i,l){n.forEach(function(c){qe[c]=i});function g(c){var v=l(c);v.length!==n.length&&_t("Mismatched type converter count");for(var b=0;b<n.length;++b)Ue(n[b],v[b])}var e=new Array(i.length),r=[],u=0;i.forEach((c,v)=>{ct.hasOwnProperty(c)?e[v]=ct[c]:(r.push(c),yt.hasOwnProperty(c)||(yt[c]=[]),yt[c].push(()=>{e[v]=ct[c],++u,u===r.length&&g(e)}))}),r.length===0&&g(e)}function Ze(n){var i=Me[n];delete Me[n];var l=i.rawConstructor,g=i.rawDestructor,e=i.fields,r=e.map(u=>u.getterReturnType).concat(e.map(u=>u.setterArgumentType));re([n],r,u=>{var c={};return e.forEach((v,b)=>{var T=v.fieldName,w=u[b],A=v.getter,j=v.getterContext,U=u[b+e.length],z=v.setter,Y=v.setterContext;c[T]={read:he=>w.fromWireType(A(j,he)),write:(he,ue)=>{var ve=[];z(Y,he,U.toWireType(ve,ue)),kt(ve)}}}),[{name:i.name,fromWireType:function(v){var b={};for(var T in c)b[T]=c[T].read(v);return g(v),b},toWireType:function(v,b){for(var T in c)if(!(T in b))throw new TypeError('Missing field:  "'+T+'"');var w=l();for(T in c)c[T].write(w,b[T]);return v!==null&&v.push(g,w),w},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:g}]})}function cr(n,i,l,g,e){}function Xt(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}function Tr(){for(var n=new Array(256),i=0;i<256;++i)n[i]=String.fromCharCode(i);Yt=n}var Yt=void 0;function $e(n){for(var i="",l=n;le[l];)i+=Yt[le[l++]];return i}var Rt=void 0;function se(n){throw new Rt(n)}function Ue(n,i,l={}){if(!("argPackAdvance"in i))throw new TypeError("registerType registeredInstance requires argPackAdvance");var g=i.name;if(n||se('type "'+g+'" must have a positive integer typeid pointer'),ct.hasOwnProperty(n)){if(l.ignoreDuplicateRegistrations)return;se("Cannot register type '"+g+"' twice")}if(ct[n]=i,delete qe[n],yt.hasOwnProperty(n)){var e=yt[n];delete yt[n],e.forEach(r=>r())}}function lr(n,i,l,g,e){var r=Xt(l);i=$e(i),Ue(n,{name:i,fromWireType:function(u){return!!u},toWireType:function(u,c){return c?g:e},argPackAdvance:8,readValueFromPointer:function(u){var c;if(l===1)c=me;else if(l===2)c=ge;else if(l===4)c=Z;else throw new TypeError("Unknown boolean type size: "+i);return this.fromWireType(c[u>>r])},destructorFunction:null})}function lt(n){if(!(this instanceof Pt)||!(n instanceof Pt))return!1;for(var i=this.$$.ptrType.registeredClass,l=this.$$.ptr,g=n.$$.ptrType.registeredClass,e=n.$$.ptr;i.baseClass;)l=i.upcast(l),i=i.baseClass;for(;g.baseClass;)e=g.upcast(e),g=g.baseClass;return i===g&&l===e}function Cr(n){return{count:n.count,deleteScheduled:n.deleteScheduled,preservePointerOnDelete:n.preservePointerOnDelete,ptr:n.ptr,ptrType:n.ptrType,smartPtr:n.smartPtr,smartPtrType:n.smartPtrType}}function xt(n){function i(l){return l.$$.ptrType.registeredClass.name}se(i(n)+" instance already deleted")}var et=!1;function dr(n){}function mt(n){n.smartPtr?n.smartPtrType.rawDestructor(n.smartPtr):n.ptrType.registeredClass.rawDestructor(n.ptr)}function Kt(n){n.count.value-=1;var i=n.count.value===0;i&&mt(n)}function Wr(n,i,l){if(i===l)return n;if(l.baseClass===void 0)return null;var g=Wr(n,i,l.baseClass);return g===null?null:l.downcast(g)}var Le={};function fn(){return Object.keys(Ve).length}function Qt(){var n=[];for(var i in Ve)Ve.hasOwnProperty(i)&&n.push(Ve[i]);return n}var Et=[];function Ar(){for(;Et.length;){var n=Et.pop();n.$$.deleteScheduled=!1,n.delete()}}var bt=void 0;function St(n){bt=n,Et.length&&bt&&bt(Ar)}function Hr(){t.getInheritedInstanceCount=fn,t.getLiveInheritedInstances=Qt,t.flushPendingDeletes=Ar,t.setDelayFunction=St}var Ve={};function Mr(n,i){for(i===void 0&&se("ptr should not be undefined");n.baseClass;)i=n.upcast(i),n=n.baseClass;return i}function $r(n,i){return i=Mr(n,i),Ve[i]}function tt(n,i){(!i.ptrType||!i.ptr)&&_t("makeClassHandle requires ptr and ptrType");var l=!!i.smartPtrType,g=!!i.smartPtr;return l!==g&&_t("Both smartPtrType and smartPtr must be specified"),i.count={value:1},Zt(Object.create(n,{$$:{value:i}}))}function pr(n){var i=this.getPointee(n);if(!i)return this.destructor(n),null;var l=$r(this.registeredClass,i);if(l!==void 0){if(l.$$.count.value===0)return l.$$.ptr=i,l.$$.smartPtr=n,l.clone();var g=l.clone();return this.destructor(n),g}function e(){return this.isSmartPointer?tt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:i,smartPtrType:this,smartPtr:n}):tt(this.registeredClass.instancePrototype,{ptrType:this,ptr:n})}var r=this.registeredClass.getActualType(i),u=Le[r];if(!u)return e.call(this);var c;this.isConst?c=u.constPointerType:c=u.pointerType;var v=Wr(i,this.registeredClass,c.registeredClass);return v===null?e.call(this):this.isSmartPointer?tt(c.registeredClass.instancePrototype,{ptrType:c,ptr:v,smartPtrType:this,smartPtr:n}):tt(c.registeredClass.instancePrototype,{ptrType:c,ptr:v})}function Zt(n){return typeof FinalizationRegistry>"u"?(Zt=i=>i,n):(et=new FinalizationRegistry(i=>{Kt(i.$$)}),Zt=i=>{var l=i.$$,g=!!l.smartPtr;if(g){var e={$$:l};et.register(i,e,i)}return i},dr=i=>et.unregister(i),Zt(n))}function cn(){if(this.$$.ptr||xt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var n=Zt(Object.create(Object.getPrototypeOf(this),{$$:{value:Cr(this.$$)}}));return n.$$.count.value+=1,n.$$.deleteScheduled=!1,n}function Rr(){this.$$.ptr||xt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&se("Object already scheduled for deletion"),dr(this),Kt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function ln(){return!this.$$.ptr}function dn(){return this.$$.ptr||xt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&se("Object already scheduled for deletion"),Et.push(this),Et.length===1&&bt&&bt(Ar),this.$$.deleteScheduled=!0,this}function wt(){Pt.prototype.isAliasOf=lt,Pt.prototype.clone=cn,Pt.prototype.delete=Rr,Pt.prototype.isDeleted=ln,Pt.prototype.deleteLater=dn}function Pt(){}function dt(n,i,l){if(n[i].overloadTable===void 0){var g=n[i];n[i]=function(){return n[i].overloadTable.hasOwnProperty(arguments.length)||se("Function '"+l+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+n[i].overloadTable+")!"),n[i].overloadTable[arguments.length].apply(this,arguments)},n[i].overloadTable=[],n[i].overloadTable[g.argCount]=g}}function er(n,i,l){t.hasOwnProperty(n)?((l===void 0||t[n].overloadTable!==void 0&&t[n].overloadTable[l]!==void 0)&&se("Cannot register public name '"+n+"' twice"),dt(t,n,n),t.hasOwnProperty(l)&&se("Cannot register multiple overloads of a function with the same number of arguments ("+l+")!"),t[n].overloadTable[l]=i):(t[n]=i,l!==void 0&&(t[n].numArguments=l))}function Lr(n,i,l,g,e,r,u,c){this.name=n,this.constructor=i,this.instancePrototype=l,this.rawDestructor=g,this.baseClass=e,this.getActualType=r,this.upcast=u,this.downcast=c,this.pureVirtualFunctions=[]}function We(n,i,l){for(;i!==l;)i.upcast||se("Expected null or instance of "+l.name+", got an instance of "+i.name),n=i.upcast(n),i=i.baseClass;return n}function Vr(n,i){if(i===null)return this.isReference&&se("null is not a valid "+this.name),0;i.$$||se('Cannot pass "'+kr(i)+'" as a '+this.name),i.$$.ptr||se("Cannot pass deleted object as a pointer of type "+this.name);var l=i.$$.ptrType.registeredClass,g=We(i.$$.ptr,l,this.registeredClass);return g}function rt(n,i){var l;if(i===null)return this.isReference&&se("null is not a valid "+this.name),this.isSmartPointer?(l=this.rawConstructor(),n!==null&&n.push(this.rawDestructor,l),l):0;i.$$||se('Cannot pass "'+kr(i)+'" as a '+this.name),i.$$.ptr||se("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&i.$$.ptrType.isConst&&se("Cannot convert argument of type "+(i.$$.smartPtrType?i.$$.smartPtrType.name:i.$$.ptrType.name)+" to parameter type "+this.name);var g=i.$$.ptrType.registeredClass;if(l=We(i.$$.ptr,g,this.registeredClass),this.isSmartPointer)switch(i.$$.smartPtr===void 0&&se("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:i.$$.smartPtrType===this?l=i.$$.smartPtr:se("Cannot convert argument of type "+(i.$$.smartPtrType?i.$$.smartPtrType.name:i.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:l=i.$$.smartPtr;break;case 2:if(i.$$.smartPtrType===this)l=i.$$.smartPtr;else{var e=i.clone();l=this.rawShare(l,ir.toHandle(function(){e.delete()})),n!==null&&n.push(this.rawDestructor,l)}break;default:se("Unsupporting sharing policy")}return l}function tr(n,i){if(i===null)return this.isReference&&se("null is not a valid "+this.name),0;i.$$||se('Cannot pass "'+kr(i)+'" as a '+this.name),i.$$.ptr||se("Cannot pass deleted object as a pointer of type "+this.name),i.$$.ptrType.isConst&&se("Cannot convert argument of type "+i.$$.ptrType.name+" to parameter type "+this.name);var l=i.$$.ptrType.registeredClass,g=We(i.$$.ptr,l,this.registeredClass);return g}function Fe(n){return this.rawGetPointee&&(n=this.rawGetPointee(n)),n}function rr(n){this.rawDestructor&&this.rawDestructor(n)}function Br(n){n!==null&&n.delete()}function He(){pt.prototype.getPointee=Fe,pt.prototype.destructor=rr,pt.prototype.argPackAdvance=8,pt.prototype.readValueFromPointer=Ne,pt.prototype.deleteObject=Br,pt.prototype.fromWireType=pr}function pt(n,i,l,g,e,r,u,c,v,b,T){this.name=n,this.registeredClass=i,this.isReference=l,this.isConst=g,this.isSmartPointer=e,this.pointeeType=r,this.sharingPolicy=u,this.rawGetPointee=c,this.rawConstructor=v,this.rawShare=b,this.rawDestructor=T,!e&&i.baseClass===void 0?g?(this.toWireType=Vr,this.destructorFunction=null):(this.toWireType=tr,this.destructorFunction=null):this.toWireType=rt}function Ut(n,i,l){t.hasOwnProperty(n)||_t("Replacing nonexistant public symbol"),t[n].overloadTable!==void 0&&l!==void 0?t[n].overloadTable[l]=i:(t[n]=i,t[n].argCount=l)}function Er(n,i,l){var g=t["dynCall_"+n];return l&&l.length?g.apply(null,[i].concat(l)):g.call(null,i)}function zr(n,i,l){if(n.includes("j"))return Er(n,i,l);var g=Pe(i).apply(null,l);return g}function vr(n,i){var l=[];return function(){return l.length=0,Object.assign(l,arguments),zr(n,i,l)}}function Te(n,i){n=$e(n);function l(){return n.includes("j")?vr(n,i):Pe(i)}var g=l();return typeof g!="function"&&se("unknown function pointer with signature "+n+": "+i),g}var Wt=void 0;function Ge(n){var i=$(n),l=$e(i);return h(i),l}function nr(n,i){var l=[],g={};function e(r){if(!g[r]&&!ct[r]){if(qe[r]){qe[r].forEach(e);return}l.push(r),g[r]=!0}}throw i.forEach(e),new Wt(n+": "+l.map(Ge).join([", "]))}function Sr(n,i,l,g,e,r,u,c,v,b,T,w,A){T=$e(T),r=Te(e,r),c&&(c=Te(u,c)),b&&(b=Te(v,b)),A=Te(w,A);var j=K(T);er(j,function(){nr("Cannot construct "+T+" due to unbound types",[g])}),re([n,i,l],g?[g]:[],function(U){U=U[0];var z,Y;g?(z=U.registeredClass,Y=z.instancePrototype):Y=Pt.prototype;var he=xe(j,function(){if(Object.getPrototypeOf(this)!==ue)throw new Rt("Use 'new' to construct "+T);if(ve.constructor_body===void 0)throw new Rt(T+" has no accessible constructor");var Mt=ve.constructor_body[arguments.length];if(Mt===void 0)throw new Rt("Tried to invoke ctor of "+T+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(ve.constructor_body).toString()+") parameters instead!");return Mt.apply(this,arguments)}),ue=Object.create(Y,{constructor:{value:he}});he.prototype=ue;var ve=new Lr(T,he,ue,A,z,r,c,b),it=new pt(T,ve,!0,!1,!1),It=new pt(T+"*",ve,!1,!1,!1),on=new pt(T+" const*",ve,!1,!0,!1);return Le[n]={pointerType:It,constPointerType:on},Ut(j,he),[it,It,on]})}function Ae(n,i){for(var l=[],g=0;g<n;g++)l.push(ne[i+g*4>>2]);return l}function Nr(n,i){if(!(n instanceof Function))throw new TypeError("new_ called with constructor type "+typeof n+" which is not a function");var l=xe(n.name||"unknownFunctionName",function(){});l.prototype=n.prototype;var g=new l,e=n.apply(g,i);return e instanceof Object?e:g}function Je(n,i,l,g,e){var r=i.length;r<2&&se("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var u=i[1]!==null&&l!==null,c=!1,v=1;v<i.length;++v)if(i[v]!==null&&i[v].destructorFunction===void 0){c=!0;break}for(var b=i[0].name!=="void",T="",w="",v=0;v<r-2;++v)T+=(v!==0?", ":"")+"arg"+v,w+=(v!==0?", ":"")+"arg"+v+"Wired";var A="return function "+K(n)+"("+T+`) {
if (arguments.length !== `+(r-2)+`) {
throwBindingError('function `+n+" called with ' + arguments.length + ' arguments, expected "+(r-2)+` args!');
}
`;c&&(A+=`var destructors = [];
`);var j=c?"destructors":"null",U=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],z=[se,g,e,kt,i[0],i[1]];u&&(A+="var thisWired = classParam.toWireType("+j+`, this);
`);for(var v=0;v<r-2;++v)A+="var arg"+v+"Wired = argType"+v+".toWireType("+j+", arg"+v+"); // "+i[v+2].name+`
`,U.push("argType"+v),z.push(i[v+2]);if(u&&(w="thisWired"+(w.length>0?", ":"")+w),A+=(b?"var rv = ":"")+"invoker(fn"+(w.length>0?", ":"")+w+`);
`,c)A+=`runDestructors(destructors);
`;else for(var v=u?1:2;v<i.length;++v){var Y=v===1?"thisWired":"arg"+(v-2)+"Wired";i[v].destructorFunction!==null&&(A+=Y+"_dtor("+Y+"); // "+i[v].name+`
`,U.push(Y+"_dtor"),z.push(i[v].destructorFunction))}b&&(A+=`var ret = retType.fromWireType(rv);
return ret;
`),A+=`}
`,U.push(A);var he=Nr(Function,U).apply(null,z);return he}function pn(n,i,l,g,e,r){ht(i>0);var u=Ae(i,l);e=Te(g,e),re([],[n],function(c){c=c[0];var v="constructor "+c.name;if(c.registeredClass.constructor_body===void 0&&(c.registeredClass.constructor_body=[]),c.registeredClass.constructor_body[i-1]!==void 0)throw new Rt("Cannot register multiple constructors with identical number of parameters ("+(i-1)+") for class '"+c.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return c.registeredClass.constructor_body[i-1]=()=>{nr("Cannot construct "+c.name+" due to unbound types",u)},re([],u,function(b){return b.splice(1,0,null),c.registeredClass.constructor_body[i-1]=Je(v,b,null,e,r),[]}),[]})}function Fr(n,i,l,g,e,r,u,c){var v=Ae(l,g);i=$e(i),r=Te(e,r),re([],[n],function(b){b=b[0];var T=b.name+"."+i;i.startsWith("@@")&&(i=Symbol[i.substring(2)]),c&&b.registeredClass.pureVirtualFunctions.push(i);function w(){nr("Cannot call "+T+" due to unbound types",v)}var A=b.registeredClass.instancePrototype,j=A[i];return j===void 0||j.overloadTable===void 0&&j.className!==b.name&&j.argCount===l-2?(w.argCount=l-2,w.className=b.name,A[i]=w):(dt(A,i,T),A[i].overloadTable[l-2]=w),re([],v,function(U){var z=Je(T,U,b,r,u);return A[i].overloadTable===void 0?(z.argCount=l-2,A[i]=z):A[i].overloadTable[l-2]=z,[]}),[]})}var vt=[],nt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function hr(n){n>4&&--nt[n].refcount===0&&(nt[n]=void 0,vt.push(n))}function vn(){for(var n=0,i=5;i<nt.length;++i)nt[i]!==void 0&&++n;return n}function hn(){for(var n=5;n<nt.length;++n)if(nt[n]!==void 0)return nt[n];return null}function qr(){t.count_emval_handles=vn,t.get_first_emval=hn}var ir={toValue:n=>(n||se("Cannot use deleted val. handle = "+n),nt[n].value),toHandle:n=>{switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var i=vt.length?vt.pop():nt.length;return nt[i]={refcount:1,value:n},i}}}};function gn(n,i){i=$e(i),Ue(n,{name:i,fromWireType:function(l){var g=ir.toValue(l);return hr(l),g},toWireType:function(l,g){return ir.toHandle(g)},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:null})}function kr(n){if(n===null)return"null";var i=typeof n;return i==="object"||i==="array"||i==="function"?n.toString():""+n}function Gr(n,i){switch(i){case 2:return function(l){return this.fromWireType(de[l>>2])};case 3:return function(l){return this.fromWireType(Oe[l>>3])};default:throw new TypeError("Unknown float type: "+n)}}function yn(n,i,l){var g=Xt(l);i=$e(i),Ue(n,{name:i,fromWireType:function(e){return e},toWireType:function(e,r){return r},argPackAdvance:8,readValueFromPointer:Gr(i,g),destructorFunction:null})}function _n(n,i,l,g,e,r){var u=Ae(i,l);n=$e(n),e=Te(g,e),er(n,function(){nr("Cannot call "+n+" due to unbound types",u)},i-1),re([],u,function(c){var v=[c[0],null].concat(c.slice(1));return Ut(n,Je(n,v,null,e,r),i-1),[]})}function mn(n,i,l){switch(i){case 0:return l?function(e){return me[e]}:function(e){return le[e]};case 1:return l?function(e){return ge[e>>1]}:function(e){return ce[e>>1]};case 2:return l?function(e){return Z[e>>2]}:function(e){return ne[e>>2]};default:throw new TypeError("Unknown integer type: "+n)}}function bn(n,i,l,g,e){i=$e(i);var r=Xt(l),u=w=>w;if(g===0){var c=32-8*l;u=w=>w<<c>>>c}var v=i.includes("unsigned"),b=(w,A)=>{},T;v?T=function(w,A){return b(A,this.name),A>>>0}:T=function(w,A){return b(A,this.name),A},Ue(n,{name:i,fromWireType:u,toWireType:T,argPackAdvance:8,readValueFromPointer:mn(i,r,g!==0),destructorFunction:null})}function wn(n,i,l){var g=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],e=g[i];function r(u){u=u>>2;var c=ne,v=c[u],b=c[u+1];return new e(st,b,v)}l=$e(l),Ue(n,{name:l,fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{ignoreDuplicateRegistrations:!0})}function Pn(n,i){i=$e(i);var l=i==="std::string";Ue(n,{name:i,fromWireType:function(g){var e=ne[g>>2],r=g+4,u;if(l)for(var c=r,v=0;v<=e;++v){var b=r+v;if(v==e||le[b]==0){var T=b-c,w=at(c,T);u===void 0?u=w:(u+="\0",u+=w),c=b+1}}else{for(var A=new Array(e),v=0;v<e;++v)A[v]=String.fromCharCode(le[r+v]);u=A.join("")}return h(g),u},toWireType:function(g,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r,u=typeof e=="string";u||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array||se("Cannot pass non-string to std::string"),l&&u?r=Lt(e):r=e.length;var c=f(4+r+1),v=c+4;if(ne[c>>2]=r,l&&u)_r(e,v,r+1);else if(u)for(var b=0;b<r;++b){var T=e.charCodeAt(b);T>255&&(h(v),se("String has UTF-16 code units that do not fit in 8 bits")),le[v+b]=T}else for(var b=0;b<r;++b)le[v+b]=e[b];return g!==null&&g.push(h,c),c},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:function(g){h(g)}})}var Jr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Tn(n,i){for(var l=n,g=l>>1,e=g+i/2;!(g>=e)&&ce[g];)++g;if(l=g<<1,l-n>32&&Jr)return Jr.decode(le.subarray(n,l));for(var r="",u=0;!(u>=i/2);++u){var c=ge[n+u*2>>1];if(c==0)break;r+=String.fromCharCode(c)}return r}function Xr(n,i,l){if(l===void 0&&(l=2147483647),l<2)return 0;l-=2;for(var g=i,e=l<n.length*2?l/2:n.length,r=0;r<e;++r){var u=n.charCodeAt(r);ge[i>>1]=u,i+=2}return ge[i>>1]=0,i-g}function Yr(n){return n.length*2}function Cn(n,i){for(var l=0,g="";!(l>=i/4);){var e=Z[n+l*4>>2];if(e==0)break;if(++l,e>=65536){var r=e-65536;g+=String.fromCharCode(55296|r>>10,56320|r&1023)}else g+=String.fromCharCode(e)}return g}function Kr(n,i,l){if(l===void 0&&(l=2147483647),l<4)return 0;for(var g=i,e=g+l-4,r=0;r<n.length;++r){var u=n.charCodeAt(r);if(u>=55296&&u<=57343){var c=n.charCodeAt(++r);u=65536+((u&1023)<<10)|c&1023}if(Z[i>>2]=u,i+=4,i+4>e)break}return Z[i>>2]=0,i-g}function Qr(n){for(var i=0,l=0;l<n.length;++l){var g=n.charCodeAt(l);g>=55296&&g<=57343&&++l,i+=4}return i}function Dr(n,i,l){l=$e(l);var g,e,r,u,c;i===2?(g=Tn,e=Xr,u=Yr,r=()=>ce,c=1):i===4&&(g=Cn,e=Kr,u=Qr,r=()=>ne,c=2),Ue(n,{name:l,fromWireType:function(v){for(var b=ne[v>>2],T=r(),w,A=v+4,j=0;j<=b;++j){var U=v+4+j*i;if(j==b||T[U>>c]==0){var z=U-A,Y=g(A,z);w===void 0?w=Y:(w+="\0",w+=Y),A=U+i}}return h(v),w},toWireType:function(v,b){typeof b!="string"&&se("Cannot pass non-string to C++ string type "+l);var T=u(b),w=f(4+T+i);return ne[w>>2]=T>>c,e(b,w+4,T+i),v!==null&&v.push(h,w),w},argPackAdvance:8,readValueFromPointer:Ne,destructorFunction:function(v){h(v)}})}function Zr(n,i,l,g,e,r){Me[n]={name:$e(i),rawConstructor:Te(l,g),rawDestructor:Te(e,r),fields:[]}}function An(n,i,l,g,e,r,u,c,v,b){Me[n].fields.push({fieldName:$e(i),getterReturnType:l,getter:Te(g,e),getterContext:r,setterArgumentType:u,setter:Te(c,v),setterContext:b})}function en(n,i){i=$e(i),Ue(n,{isVoid:!0,name:i,argPackAdvance:0,fromWireType:function(){},toWireType:function(l,g){}})}function $n(n){n>4&&(nt[n].refcount+=1)}function xr(n,i){var l=ct[n];return l===void 0&&se(i+" has unknown type "+Ge(n)),l}function Rn(n,i){n=xr(n,"_emval_take_value");var l=n.readValueFromPointer(i);return ir.toHandle(l)}function En(){Be("")}function Sn(n,i,l){le.copyWithin(n,i,i+l)}function Fn(){return 2147483648}function Or(n){try{return _e.grow(n-st.byteLength+65535>>>16),pe(_e.buffer),1}catch{}}function kn(n){var i=le.length;n=n>>>0;var l=Fn();if(n>l)return!1;let g=(v,b)=>v+(b-v%b)%b;for(var e=1;e<=4;e*=2){var r=i*(1+.2/e);r=Math.min(r,n+100663296);var u=Math.min(l,g(Math.max(n,r),65536)),c=Or(u);if(c)return!0}return!1}function Ot(n){return 52}function gr(n,i,l,g,e){return 70}var Tt=[null,[],[]];function Ht(n,i){var l=Tt[n];i===0||i===10?((n===1?Ce:be)(Xe(l,0)),l.length=0):l.push(i)}function tn(n,i,l,g){for(var e=0,r=0;r<l;r++){var u=ne[i>>2],c=ne[i+4>>2];i+=8;for(var v=0;v<c;v++)Ht(n,le[u+v]);e+=c}return ne[g>>2]=e,0}function Ir(n){return n}function rn(n){var i=t["_"+n];return i}function yr(n,i){me.set(n,i)}function nn(n,i,l,g,e){var r={string:U=>{var z=0;if(U!=null&&U!==0){var Y=(U.length<<2)+1;z=O(Y),_r(U,z,Y)}return z},array:U=>{var z=O(U.length);return yr(U,z),z}};function u(U){return i==="string"?at(U):i==="boolean"?!!U:U}var c=rn(n),v=[],b=0;if(g)for(var T=0;T<g.length;T++){var w=r[l[T]];w?(b===0&&(b=D()),v[T]=w(g[T])):v[T]=g[T]}var A=c.apply(null,v);function j(U){return b!==0&&R(b),u(U)}return A=j(A),A}ye=t.InternalError=ie(Error,"InternalError"),Tr(),Rt=t.BindingError=ie(Error,"BindingError"),wt(),Hr(),He(),Wt=t.UnboundTypeError=ie(Error,"UnboundTypeError"),qr();var s={__assert_fail:wr,__cxa_begin_catch:ft,__cxa_end_catch:At,__cxa_find_matching_catch_2:$t,__cxa_find_matching_catch_3:fr,__cxa_throw:jt,__resumeException:gt,_embind_finalize_value_object:Ze,_embind_register_bigint:cr,_embind_register_bool:lr,_embind_register_class:Sr,_embind_register_class_constructor:pn,_embind_register_class_function:Fr,_embind_register_emval:gn,_embind_register_float:yn,_embind_register_function:_n,_embind_register_integer:bn,_embind_register_memory_view:wn,_embind_register_std_string:Pn,_embind_register_std_wstring:Dr,_embind_register_value_object:Zr,_embind_register_value_object_field:An,_embind_register_void:en,_emval_decref:hr,_emval_incref:$n,_emval_take_value:Rn,abort:En,emscripten_memcpy_big:Sn,emscripten_resize_heap:kn,fd_close:Ot,fd_seek:gr,fd_write:tn,invoke_i:m,invoke_ii:X,invoke_iii:I,invoke_iiii:p,invoke_v:o,invoke_vi:ee,invoke_viiii:a,invoke_viiiiii:C,llvm_eh_typeid_for:Ir};sr(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.__wasm_call_ctors).apply(null,arguments)};var f=t._malloc=function(){return(f=t._malloc=t.asm.malloc).apply(null,arguments)},h=t._free=function(){return(h=t._free=t.asm.free).apply(null,arguments)},P=t.___cxa_free_exception=function(){return(P=t.___cxa_free_exception=t.asm.__cxa_free_exception).apply(null,arguments)},$=t.___getTypeName=function(){return($=t.___getTypeName=t.asm.__getTypeName).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm._embind_initialize_bindings).apply(null,arguments)},t.___errno_location=function(){return(t.___errno_location=t.asm.__errno_location).apply(null,arguments)};var k=t.setTempRet0=function(){return(k=t.setTempRet0=t.asm.setTempRet0).apply(null,arguments)},D=t.stackSave=function(){return(D=t.stackSave=t.asm.stackSave).apply(null,arguments)},R=t.stackRestore=function(){return(R=t.stackRestore=t.asm.stackRestore).apply(null,arguments)},O=t.stackAlloc=function(){return(O=t.stackAlloc=t.asm.stackAlloc).apply(null,arguments)},M=t.___cxa_can_catch=function(){return(M=t.___cxa_can_catch=t.asm.__cxa_can_catch).apply(null,arguments)},G=t.___cxa_is_pointer_type=function(){return(G=t.___cxa_is_pointer_type=t.asm.__cxa_is_pointer_type).apply(null,arguments)};t.dynCall_ji=function(){return(t.dynCall_ji=t.asm.dynCall_ji).apply(null,arguments)},t.dynCall_iiji=function(){return(t.dynCall_iiji=t.asm.dynCall_iiji).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.dynCall_jiji).apply(null,arguments)};function X(n,i){var l=D();try{return Pe(n)(i)}catch(g){if(R(l),g!==g+0)throw g;_setThrew(1,0)}}function ee(n,i){var l=D();try{Pe(n)(i)}catch(g){if(R(l),g!==g+0)throw g;_setThrew(1,0)}}function a(n,i,l,g,e){var r=D();try{Pe(n)(i,l,g,e)}catch(u){if(R(r),u!==u+0)throw u;_setThrew(1,0)}}function o(n){var i=D();try{Pe(n)()}catch(l){if(R(i),l!==l+0)throw l;_setThrew(1,0)}}function p(n,i,l,g){var e=D();try{return Pe(n)(i,l,g)}catch(r){if(R(e),r!==r+0)throw r;_setThrew(1,0)}}function m(n){var i=D();try{return Pe(n)()}catch(l){if(R(i),l!==l+0)throw l;_setThrew(1,0)}}function C(n,i,l,g,e,r,u){var c=D();try{Pe(n)(i,l,g,e,r,u)}catch(v){if(R(c),v!==v+0)throw v;_setThrew(1,0)}}function I(n,i,l){var g=D();try{return Pe(n)(i,l)}catch(e){if(R(g),e!==e+0)throw e;_setThrew(1,0)}}t.ccall=nn;var x;Ke=function n(){x||E(),x||(Ke=n)};function E(n){if(Ye>0||(mr(),Ye>0))return;function i(){x||(x=!0,t.calledRun=!0,!Re&&(jr(),B(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),Ur()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),i()},1)):i()}if(t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return E(),t.ready}})();d.exports=_}(Yn)),Yn.exports}var go=ho(),yo=Nn(go);const _o=new URL("/nifti-viewer/assets/openjphjs-C-BUUy4a.wasm",import.meta.url),jn={codec:void 0,decoder:void 0,decodeConfig:{}};function mo(d,y,_){const F={width:y,height:_};for(;d>0;)F.width=Math.ceil(F.width/2),F.height=Math.ceil(F.height/2),d--;return F}function bo(d){if(jn.decodeConfig=d,jn.codec)return Promise.resolve();const y=yo({locateFile:_=>_.endsWith(".wasm")?_o.toString():_});return new Promise((_,F)=>{y.then(S=>{jn.codec=S,jn.decoder=new S.HTJ2KDecoder,_()},F)})}async function wo(d,y){await bo();const _=new jn.codec.HTJ2KDecoder,F=_.getEncodedBuffer(d.length);F.set(d);const S=y.decodeLevel||0;_.decodeSubResolution(S);const t=_.getFrameInfo();if(y.decodeLevel>0){const{width:ot,height:Xe}=mo(y.decodeLevel,t.width,t.height);t.width=ot,t.height=Xe}const B=_.getDecodedBuffer();new Uint8Array(B.length).set(B);const H=`x: ${_.getImageOffset().x}, y: ${_.getImageOffset().y}`,N=_.getNumDecompositions(),V=_.getNumLayers(),q=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][_.getProgressionOrder()+1],L=_.getIsReversible(),Q=`${_.getBlockDimensions().width} x ${_.getBlockDimensions().height}`,J=`${_.getTileSize().width} x ${_.getTileSize().height}`,te=`${_.getTileOffset().x}, ${_.getTileOffset().y}`,ae=`${B.length.toLocaleString()} bytes`,Se=`${(B.length/F.length).toFixed(2)}:1`,fe={columns:t.width,rows:t.height,bitsPerPixel:t.bitsPerSample,signed:t.isSigned,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:t.componentCount};let Ce=Po(t,B);const{buffer:be,byteOffset:oe,byteLength:_e}=Ce,Re=be.slice(oe,oe+_e);Ce=new Ce.constructor(Re);const ht={imageOffset:H,numDecompositions:N,numLayers:V,progessionOrder:q,reversible:L,blockDimensions:Q,tileSize:J,tileOffset:te,decodedSize:ae,compressionRatio:Se};return{...y,pixelData:Ce,imageInfo:fe,encodeOptions:ht,...ht,...fe}}function Po(d,y){return d.bitsPerSample>8?d.isSigned?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):d.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}function To(d,y){const _=d.length,{rescaleSlope:F,rescaleIntercept:S,suvbw:t}=y;if(y.modality==="PT"&&typeof t=="number"&&!isNaN(t))for(let B=0;B<_;B++)d[B]=t*(d[B]*F+S);else for(let B=0;B<_;B++)d[B]=d[B]*F+S;return!0}function Co(d){let y=d[0],_=d[0],F;const S=d.length;for(let t=1;t<S;t++)F=d[t],y=Math.min(y,F),_=Math.max(_,F);return{min:y,max:_}}function yi(d,y){let _;return Number.isInteger(d)&&Number.isInteger(y)&&(d>=0?y<=255?_=Uint8Array:y<=65535&&(_=Uint16Array):d>=-128&&y<=127?_=Int8Array:d>=-32768&&y<=32767&&(_=Int16Array)),_||Float32Array}function Ao(d,y,_){return yi(d,y)===_}function $o(d){return d==="RGB"||d==="PALETTE COLOR"||d==="YBR_FULL"||d==="YBR_FULL_422"||d==="YBR_PARTIAL_422"||d==="YBR_PARTIAL_420"||d==="YBR_RCT"||d==="YBR_ICT"}const Ro={bilinear:wi,replicate:Pi},Eo={Uint8Array,Uint16Array,Int16Array,Float32Array};function So(d,y,_,F){var fe,Ce,be;const S=d.pixelRepresentation!==void 0&&d.pixelRepresentation===1,t=S&&d.bitsStored!==void 0?32-d.bitsStored:void 0;if(S&&t!==void 0)for(let oe=0;oe<d.pixelData.length;oe++)d.pixelData[oe]=d.pixelData[oe]<<t>>t;let B=d.pixelData;d.pixelDataLength=d.pixelData.length;const{min:W,max:H}=Co(d.pixelData),N=typeof y.allowFloatRendering<"u"?y.allowFloatRendering:!0;let V=$o(d.photometricInterpretation)&&((fe=y.targetBuffer)==null?void 0:fe.offset)===void 0;const L=((Ce=y.preScale)==null?void 0:Ce.enabled)&&Object.values(y.preScale.scalingParameters).some(oe=>typeof oe=="number"&&!Number.isInteger(oe)),Q=!y.preScale.enabled||!N&&L,J=(be=y.targetBuffer)==null?void 0:be.type;if(J&&y.preScale.enabled&&!Q){const{rescaleSlope:oe,rescaleIntercept:_e}=y.preScale.scalingParameters,Re=oe*W+_e,ht=oe*H+_e;V=!Ao(Re,ht,J)}J&&!V?B=Fo(y,d,Eo,B):y.preScale.enabled&&!Q?B=ko(y,W,H,d):B=_i(W,H,d);let te=W,ae=H;if(y.preScale.enabled&&!Q){const oe=y.preScale.scalingParameters;mi(oe);const{rescaleSlope:_e,rescaleIntercept:Re}=oe;if(typeof _e=="number"&&typeof Re=="number"){To(B,oe),d.preScale={...y.preScale,scaled:!0};const{rescaleIntercept:ot,rescaleSlope:Xe,suvbw:at}=oe;te=Xe*W+ot,ae=Xe*H+ot,at&&(te=te*at,ae=ae*at)}}else Q&&(d.preScale={enabled:!0,scaled:!1},te=W,ae=H);d.pixelData=B,d.smallestPixelValue=te,d.largestPixelValue=ae;const Se=new Date().getTime();return d.decodeTimeInMS=Se-_,d}function Fo(d,y,_,F){const{arrayBuffer:S,type:t,offset:B=0,length:W,rows:H}=d.targetBuffer,N=_[t];if(!N)throw new Error(`target array ${t} is not supported, or doesn't exist.`);H&&H!=y.rows&&xo(y,d.targetBuffer,N);const V=y.pixelDataLength,q=B,L=W??V-q,Q=y.pixelData;if(L!==Q.length)throw new Error(`target array for image does not have the same length (${L}) as the decoded image length (${Q.length}).`);const J=S?new N(S,q,L):new N(L);return J.set(Q,0),F=J,F}function ko(d,y,_,F){const S=d.preScale.scalingParameters;mi(S);const{rescaleSlope:t,rescaleIntercept:B}=S,W=typeof t=="number"&&typeof B=="number";let H=y,N=_;return W&&(H=t*y+B,N=t*_+B),_i(H,N,F)}function _i(d,y,_){const F=yi(d,y),S=new F(_.pixelData.length);return S.set(_.pixelData,0),S}function mi(d){if(!d)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}function Do(d,y,_){const{samplesPerPixel:F}=d,{rows:S,columns:t}=y,B=S*t*F,W=new _(B),H=W.byteLength/B;return{pixelData:W,rows:S,columns:t,frameInfo:{...d.frameInfo,rows:S,columns:t},imageInfo:{...d.imageInfo,rows:S,columns:t,bytesPerPixel:H}}}function xo(d,y,_){const F=Do(d,y,_),{scalingType:S="replicate"}=y;return Ro[S](d,F),Object.assign(d,F),d.pixelDataLength=d.pixelData.length,d}async function Oo(d,y,_,F,S,t){const B=new Date().getTime();let W=null,H;switch(y){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":W=ni(d,_);break;case"1.2.840.10008.1.2.2":W=Ui(d,_);break;case"1.2.840.10008.1.2.1.99":W=ni(d,_);break;case"1.2.840.10008.1.2.5":W=Wi(d,_);break;case"1.2.840.10008.1.2.4.50":H={...d},W=Yi(_,H);break;case"1.2.840.10008.1.2.4.51":W=Zi(d,_);break;case"1.2.840.10008.1.2.4.57":W=oi(d,_);break;case"1.2.840.10008.1.2.4.70":W=oi(d,_);break;case"1.2.840.10008.1.2.4.80":H={signed:d.pixelRepresentation===1,bytesPerPixel:d.bitsAllocated<=8?1:2,...d},W=si(_,H);break;case"1.2.840.10008.1.2.4.81":H={signed:d.pixelRepresentation===1,bytesPerPixel:d.bitsAllocated<=8?1:2,...d},W=si(_,H);break;case"1.2.840.10008.1.2.4.90":H={...d},W=fi(_,H);break;case"1.2.840.10008.1.2.4.91":H={...d},W=fi(_,H);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":H={...d},W=wo(_,H);break;default:throw new Error(`no decoder for transfer syntax ${y}`)}if(!W)throw new Error("decodePromise not defined");const N=await W,V=So(N,S,B);return t==null||t(V),V}const Io={decodeTask({imageFrame:d,transferSyntax:y,decodeConfig:_,options:F,pixelData:S,callbackFn:t}){return Oo(d,y,S,_,F,t)}};Qn(Io);
